app.controller("grabCtrl",["$scope","$http","Tool","Ajax",function($scope,$http,Tool,Ajax){
	//提示框变量
	$scope.hasTip = false;
	$scope.hasComfirm = true;
	$scope.hasCancel = false;
	$scope.message = "";
	$scope.hasBg = false;
	//菜单切换变量
	$scope.hasDate = false;
	$scope.hasArea = false;
	$scope.hasClass = false;
	$scope.hasBg = false;
	//菜单项变量
	$scope.menuParams = {
		area:false,
		classes:false,
		date:false,
	}
	$scope.areaParams = {
		default:true,
		futian:false,
		nanshan:false,
		luohu:false,
		baoan:false,
		longhua:false,
		longgang:false,
		yantian:false,
	}
	$scope.dateParams={};
	$scope.dates = [];
	$scope.classParams = {
		jieya:true,
		meirong:false,
		tuina:false,
	}

	$scope.load = function(){
		Ajax.loadHost();
		$scope.loadDate();
	}

	//加载日期时间
	$scope.loadDate = function(){
		var url = Tool.getSession("host")+"/new/contents/json/date.json";
		$http.get(url)
		.success(function(data){
			for(var i in data){
				var item = data[i];
				if(i==0){
					$scope.dateParams[item.value] = true;
				}else{
					$scope.dateParams[item.value] = false;
				}
				$scope.dates.push(item.value);
			}
		}).error(function(){
			$scope.message = "加载日期异常，请稍后再试!";
			$scope.hasTip = true;
		})
	}

	//切换下拉菜单
	$scope.switchMenu =function(menu){
		switch(menu){
			case "area":
				if($scope.hasDate){
					$scope.hasDate = false;
					$scope.menuParams.date = false;
				};
				if($scope.hasClass){
					$scope.hasClass = false;
					$scope.menuParams.classes = false;
				};
				$scope.hasArea = !$scope.hasArea;
				if($scope.hasArea){
					$scope.menuParams.area = true;
				}else{
					$scope.menuParams.area = false;
				}
				break;
			case "date":
				if($scope.hasArea){
					$scope.hasArea = false;
					$scope.menuParams.area = false;
				};
				if($scope.hasClass){
					$scope.hasClass = false;
					$scope.menuParams.classes = false;
				};
				$scope.hasDate = !$scope.hasDate;
				if($scope.hasDate){
					$scope.menuParams.date = true;
				}else{
					$scope.menuParams.date = false;
				}
				break;
			case "class":
				if($scope.hasDate){
					$scope.hasDate = false;
					$scope.menuParams.date = false;
				};
				if($scope.hasArea){
					$scope.hasArea = false;
					$scope.menuParams.area = false;
				};
				$scope.hasClass = !$scope.hasClass;
				if($scope.hasClass){
					$scope.menuParams.classes = true;
				}else{
					$scope.menuParams.classes = false;
				}
				break;
		}
		if($scope.hasDate||$scope.hasArea||$scope.hasClass){
			$scope.hasBg = true;
		}else{
			$scope.hasBg = false;
		}
	}
	//时间下拉菜单项点击
	$scope.dateSelect = function(params){
		Tool.select(params,$scope.dateParams);
	}
	//区域下拉菜单项点击
	$scope.areaSelect =function(params){
		Tool.select(params,$scope.areaParams);
	}
	//分类下拉菜单项点击
	$scope.classSelect = function(params){
		Tool.select(params,$scope.classParams);
	}

	//提示窗口确认按钮处理函数
	$scope.comfirm = function(){
		$scope.hasTip = false;
	}
}])
