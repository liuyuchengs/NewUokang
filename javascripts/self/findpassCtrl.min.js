app.controller("findpassCtrl",["$scope","$http","Tool",function($scope,$http,Tool){
	$scope.phone = "";
	$scope.hasSendCode = false;

	$scope.checkPhone = function(){
		var url = Tool.getSession("host")+"/wx/findpass/findPassPhontCheck";
		var params = "name=phone&param="+$scope.phone;
		$http.post(url,params,{
			headers:{
				'Content-type':'application/x-www-form-urlencoded;charset=UTF-8',
				'Accept':"text/plain"
			}
		}).success(function(data){
			if(data=="y"){
				Tool.goPage("/new/htmls/findpwd-code.html#?phone="+$scope.phone);
			}else{
				Tool.alert($scope,"号码未注册或者错误!");
			}
		}).error(function(){
			Tool.alert($scope,"检查手机号码失败，请稍后再试!");
		})
	}

	/*
	** 验证码按钮处理函数
	*/
	$scope.getCode = function(){
		if(!$scope.hasSendCode){
			if($scope.sendSmsCode()){
				var time = 59;
				$scope.codeState = false;
				var interval = $interval(function(){
					$scope.codeText = (time+" S");
					time--;
				},1000,60).then(function(){
					$scope.codeText = "获取短信验证码";
					$scope.codeState = true;
					$interval.cancel(interval);
				})
			}
		}
	}

	$scope.sendSmsCode = function(){

	}
}])
