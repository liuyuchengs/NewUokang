app.controller("interactionDetailCtrl",["$scope","$http","$location","Tool",function($scope,$http,$location,Tool){
	$scope.loading = false;
	$scope.id=null;
	$scope.post = {};
	/*
	** 页面初始化
	*/
	$scope.load =function(){
		$scope.getQueryString();
		$scope.queryPost();
	}


	/*
	** 获取帖子id
	*/
	$scope.getQueryString = function(){
		if($location.search().id){
			$scope.id = $location.search().id;
		}else{
			Tool.goPage("/new/htmls/interaction.html");
		}
	}

	/*
	** 获取帖子详细信息
	*/
	$scope.queryPost = function(){
		var url  = Tool.getSession("host")+"/wx/post/postDetail";
		var params = "id="+$scope.id;
		$http.post(url,params,{
			headers:{
				'Content-type':'application/x-www-form-urlencoded;charset=UTF-8',
			}
		}).success(function(data){
			if(data.code==0){
				$scope.post = data.data;
			}else{
				Tool.alert($scope,data.message);
			}
		}).error(function(){
			Tool.alert($scope,"帖子信息加载失败!");
		})
	}

	/*
	** 检查帖子信息
	*/
	$scope.mergePost = function(post){
		var comment  = post.commentList;
		if(comment.length>0){
			for(var outIndex in comment){
				var reply = comment[outIndex];
				if(reply.repliesMessageList.length>0){
					reply.hasReply=true;
					replyList = reply.
					for(var inIndex in replayList.repliesMessageList){

					}
				}else{
					replayList.hasReply=false;
				}

			}
		}
	}
}])
