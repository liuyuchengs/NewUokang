app.controller("detailCtrl",["$scope","$http","$location","Tool",function($scope,$http,$location,Tool){
	$scope.hasSelectTime = false;
	$scope.productInfo;
	$scope.hospitalInfo;
	$scope.hosId;
	$scope.proId;
	/*
	**
	*/
	angular.element(document).ready(function(){
		Tool.loadUserinfo();
		$scope.hosId = $location.search().hospitalId;
		$scope.proId = $location.search().productId;
	})

	/*
	** 返回上一页
	*/
	$scope.back = function(){
		window.history.back();
	}

	/*
	** 查询项目信息
	*/
	$scope.queryProduct = function(){
		var url = Tool.getSession("host")+"/wx/product/querybyid";
		var params = "productId="+$scope.proId;
		$http.post(url,params,{
			headers:{
				'Content-type':'application/x-www-form-urlencoded;charset=UTF-8',
			}
		}).success(function(data){
			$scope.mergeProdcut(data);
			$scope.productInfo = data;
		}).error(function(){
			Tool.alert($scope,"获取项目详细信息错误，请稍后再试!");
		})
	}
	/*
	** 修改项目信息
	*/
	$scope.mergeProdcut = function(data){
		if(data.priceunit!=null&&data.priceunit!=""){
			data.preferPriceType = data.pricetype+"/"+data.priceunit;
		}else{
			data.preferPriceType = data.pricetype;
		}
	}
}])
