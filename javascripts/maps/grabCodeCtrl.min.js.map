{"version":3,"sources":["grabCodeCtrl.min.js"],"names":["app","controller","$scope","$http","$location","Tool","queryParams","productId","hospitalId","dayDate","code","userInfo","angular","element","document","ready","loadQueryParams","loadUserinfo","search","checkCode","length","alert","url","getSession","params","convertParams","post","headers","Content-type","accessToken","success","data","getGift","message","user","getLocal","giftCode","setLocal","goPage"],"mappings":"AAAAA,IAAIC,WAAW,gBAAgB,SAAS,QAAQ,YAAY,OAAO,SAASC,EAAOC,EAAMC,EAAUC,GAClGH,EAAOI,aACNC,UAAU,GACVC,WAAW,GACXC,QAAQ,GACRC,KAAK,IAENR,EAAOS,YAEPC,QAAQC,QAAQC,UAAUC,MAAM,WAC/Bb,EAAOc,kBACPX,EAAKY,aAAaf,KAEnBA,EAAOc,gBAAkB,WACrBZ,EAAUc,SAASX,YACrBL,EAAOI,YAAYC,UAAYH,EAAUc,SAASX,WAEhDH,EAAUc,SAASV,aACrBN,EAAOI,YAAYE,WAAaJ,EAAUc,SAASV,YAEjDJ,EAAUc,SAAST,UACrBP,EAAOI,YAAYG,QAAUL,EAAUc,SAAST,UAGlDP,EAAOiB,UAAY,WAClB,GAAGjB,EAAOI,YAAYI,KAAKU,OAAO,EACjCf,EAAKgB,MAAMnB,EAAO,eACb,IAAmC,GAAhCA,EAAOI,YAAYI,KAAKU,OAChCf,EAAKgB,MAAMnB,EAAO,6CACb,IAAoC,GAAjCA,EAAOI,YAAYI,KAAKU,OAAW,CAC3C,GAAIE,GAAMjB,EAAKkB,WAAW,QAAQ,sBAC9BC,EAASnB,EAAKoB,cAAcvB,EAAOI,YACvCH,GAAMuB,KAAKJ,EAAIE,GACdG,SACEC,eAAe,kDACfC,YAAc3B,EAAOS,SAASkB,eAE9BC,QAAQ,SAASC,GACL,GAAXA,EAAKrB,KACPR,EAAO8B,QAAQ9B,EAAOI,aAEtBD,EAAKgB,MAAMnB,EAAO6B,EAAKE,aAK3B/B,EAAO8B,QAAU,SAAS1B,GACzB,GAAIgB,GAAMjB,EAAKkB,WAAW,QAAQ,0BAC9BC,EAASnB,EAAKoB,cAAcnB,EAChCH,GAAMuB,KAAKJ,EAAIE,GACdG,SACEC,eAAe,kDACfC,YAAc3B,EAAOS,SAASkB,eAE9BC,QAAQ,SAASC,GACnB,GAAe,GAAZA,EAAKrB,KAAS,CAChB,GAAIwB,GAAO7B,EAAK8B,SAAS,OACzBD,GAAKE,SAAW,EAChB/B,EAAKgC,SAAS,OAAOH,GACrB7B,EAAKgC,SAAS,OAAON,EAAKA,MAC1B1B,EAAKiC,OAAO","file":"grabCodeCtrl.min.js","sourcesContent":["app.controller(\"grabCodeCtrl\",[\"$scope\",\"$http\",\"$location\",\"Tool\",function($scope,$http,$location,Tool){\r\n\t$scope.queryParams = {\r\n\t\tproductId:\"\",\r\n\t\thospitalId:\"\",\r\n\t\tdayDate:\"\",\r\n\t\tcode:\"\",\r\n\t}\r\n\t$scope.userInfo = {};\r\n\r\n\tangular.element(document).ready(function(){\r\n\t\t$scope.loadQueryParams();\r\n\t\tTool.loadUserinfo($scope);\r\n\t})\r\n\t$scope.loadQueryParams = function(){\r\n\t\tif($location.search().productId){\r\n\t\t\t$scope.queryParams.productId = $location.search().productId;\r\n\t\t}\r\n\t\tif($location.search().hospitalId){\r\n\t\t\t$scope.queryParams.hospitalId = $location.search().hospitalId;\r\n\t\t}\r\n\t\tif($location.search().dayDate){\r\n\t\t\t$scope.queryParams.dayDate = $location.search().dayDate;\r\n\t\t}\r\n\t}\r\n\t$scope.checkCode = function(){\r\n\t\tif($scope.queryParams.code.length<1){\r\n\t\t\tTool.alert($scope,\"请填写惠赠码!\");\r\n\t\t}else if($scope.queryParams.code.length!=5){\r\n\t\t\tTool.alert($scope,\"惠赠码错误，请填写正确的惠赠码！如需帮助请致电：0755-26905699\")\r\n\t\t}else if($scope.queryParams.code.length ==5){\r\n\t\t\tvar url = Tool.getSession(\"host\")+\"/wx/order/checkCode\";\r\n\t\t\tvar params = Tool.convertParams($scope.queryParams);\r\n\t\t\t$http.post(url,params,{\r\n\t\t\t\theaders:{\r\n\t\t\t\t\t 'Content-type':'application/x-www-form-urlencoded;charset=UTF-8',\r\n\t\t\t\t\t \"accessToken\":$scope.userInfo.accessToken,\r\n\t\t\t\t}\r\n\t\t\t}).success(function(data){\r\n\t\t\t\tif(data.code==0){\r\n\t\t\t\t\t$scope.getGift($scope.queryParams);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tTool.alert($scope,data.message);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\t$scope.getGift = function(queryParams){\r\n\t\tvar url = Tool.getSession(\"host\")+\"/wx/gift/getgiftproduct\";\r\n\t\tvar params = Tool.convertParams(queryParams);\r\n\t\t$http.post(url,params,{\r\n\t\t\theaders:{\r\n\t\t\t\t 'Content-type':'application/x-www-form-urlencoded;charset=UTF-8',\r\n\t\t\t\t \"accessToken\":$scope.userInfo.accessToken,\r\n\t\t\t}\r\n\t\t}).success(function(data){\r\n\t\t\tif(data.code ==0){\r\n\t\t\t\tvar user = Tool.getLocal(\"user\");\r\n\t\t\t\tuser.giftCode = 0;\r\n\t\t\t\tTool.setLocal(\"user\",user);\r\n\t\t\t\tTool.setLocal(\"gift\",data.data)\r\n\t\t\t\tTool.goPage(\"/new/htmls/grab-order.html\");\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}])\r\n"],"sourceRoot":"/source/"}