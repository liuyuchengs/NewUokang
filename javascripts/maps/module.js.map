{"version":3,"sources":["module.js"],"names":["app","angular","module","config","$routeProvider","when","templateUrl","controller","otherwise","redirectTo","service","$http","Tool","this","loadHost","scope","callback","getSession","host","get","success","data","setSession","error","err","console","log","$location","Ajax","getLocal","key","JSON","parse","localStorage","getItem","setLocal","value","setItem","stringify","removeLocal","removeItem","clearLocal","clear","sessionStorage","removeSession","goPage","path","location","href","goUrl","url","length","getHost","isLogin","isUserInfoComplete","userInfo","realname","sex","age","phone","select","params","obj","proto","has","alert","mess","message","hasCancel","hasComfirm","hasTip","comfirm","cancel","loadUserinfo","id","accessToken","convertParams","property","slice","menuClick","page","hasHomeMenu","hasDoctorMenu","hasInteractionMenu","hasUserMenu","getQueryString","name","reg","RegExp","r","window","search","substr","match","unescape","wxInit","$scope","wx","ready","checkJsApi","jsApiList","result","checkResult","getLocation","chooseWXPay","type","res","locationInfo","latitude","longitude","fail","wxConfig","debug","appId","timestamp","nonceStr","signature","param","encodeURIComponent","post","headers","Content-type","wxCheckPayParams","signType","paySign","wxPay","orderId","code","package","timeStamp","sign","loading","directive","fallbackSrc","link","iElement","iAttrs","bind","element","attr","$timeout","restrict","$last","$emit","defaultParams","default","areaParams","val","futian","nanshan","luohu","baoan","longhua","longgang","yantian","yakeParams","all","zzy","xiya","kcy","buya","baya","ycmr","jiaozheng","yichi","yzzl","qita","meirongParams","yanbu","mianbu","bibu","xiong","xizhi","simi","zhushe","jiguang","koucun","fckParams","jiancha","fenmian","zhongyiParams","toubu","jianjing","yaobu","tuibu","quanshen","jingluo","tijianParams","shangye","changgui","zhongnian","laonian","ruzhi","yunqian","qingnian","ertong","manbing","professionalParams","proId","yake","meirong","fck","zhongyi","tijian"],"mappings":"AAAA,GAAIA,KAAMC,QAAQC,OAAO,SAAS,WAKlCF,KAAIG,QAAQ,iBAAiB,SAASC,GACrCA,EAAeC,KAAK,YACnBC,YAAY,4BACZC,WAAW,oBACTF,KAAK,aACPC,YAAY,6BACZC,WAAW,qBACTC,WAAWC,WAAW,gBAM1BT,IAAIU,QAAQ,QAAQ,QAAQ,OAAO,SAASC,EAAMC,GACjDC,KAAKC,SAAW,SAASC,EAAMC,GAC3BJ,EAAKK,WAAW,SAClBF,EAAMG,KAAON,EAAKK,WAAW,QAC7BD,KAEAL,EAAMQ,IAAI,8BAA8BC,QAAQ,SAASC,GACxD,GAAIH,GAAOG,EAAKH,IAChBH,GAAMG,KAAOA,EACbN,EAAKU,WAAW,OAAOJ,GACvBF,MACEO,MAAM,SAASC,GACjBC,QAAQC,IAAIF,GACZZ,EAAKU,WAAW,OAAO,UAS3BtB,IAAIU,QAAQ,QAAQ,YAAY,SAASiB,EAAUC,GAIlDf,KAAKgB,SAAW,SAASC,GACxB,MAAOC,MAAKC,MAAMC,aAAaC,QAAQJ,KAExCjB,KAAKsB,SAAW,SAASL,EAAIM,GAC5BH,aAAaI,QAAQP,EAAIC,KAAKO,UAAUF,KAEzCvB,KAAK0B,YAAc,SAAST,GAC3BG,aAAaO,WAAWV,IAEzBjB,KAAK4B,WAAa,WACjBR,aAAaS,SAEd7B,KAAKI,WAAa,SAASa,GAC1B,MAAOC,MAAKC,MAAMW,eAAeT,QAAQJ,KAE1CjB,KAAKS,WAAa,SAASQ,EAAIM,GAC9BO,eAAeN,QAAQP,EAAIC,KAAKO,UAAUF,KAE3CvB,KAAK+B,cAAgB,SAASd,GAC7Ba,eAAeH,WAAWV,IAM3BjB,KAAKgC,OAAS,SAASC,GACnBjC,KAAKI,WAAW,UAClB8B,SAASC,KAAOnC,KAAKI,WAAW,QAAQ6B,IAO1CjC,KAAKoC,MAAQ,SAASC,GAClBA,EAAIC,OAAO,IACbJ,SAASC,KAAOE,IAOlBrC,KAAKuC,QAAU,WACd,GAAIlC,GAAO,EAIX,OAHGL,MAAKI,WAAW,UAClBC,EAAOL,KAAKI,WAAW,SAEjBC,GAERL,KAAKwC,QAAU,WACd,QAAGxC,KAAKgB,SAAS,gBAMlBhB,KAAKyC,mBAAqB,WACzB,GAAIC,GAAW1C,KAAKgB,SAAS,OAC7B,OAAsB,IAAnB0B,EAASC,UAAiC,MAAnBD,EAASC,UAA8B,IAAdD,EAASE,KAAuB,MAAdF,EAASE,KAAyB,IAAdF,EAASG,KAAuB,MAAdH,EAASG,KAA2B,IAAhBH,EAASI,OAA2B,MAAhBJ,EAASI,OAM7J9C,KAAK+C,OAAS,SAASC,EAAOC,GAC7B,IAAI,GAAIC,KAASD,GACbC,GAAOF,EACLC,EAAID,GAAQG,MACfF,EAAID,GAAQG,KAAM,GAGhBF,EAAIC,GAAOC,MACbF,EAAIC,GAAOC,KAAM,IAMrBnD,KAAKoD,MAAQ,SAASlD,EAAMmD,EAAKlD,GAChCD,EAAMoD,QAAUD,EAChBnD,EAAMqD,WAAY,EAClBrD,EAAMsD,YAAa,EACnBtD,EAAMuD,QAAS,EACZtD,EACFD,EAAMwD,QAAUvD,EAEhBD,EAAMwD,QAAU,WACfxD,EAAMuD,QAAS,IAKlBzD,KAAK0D,QAAU,SAASxD,EAAMmD,EAAKlD,GAClCD,EAAMoD,QAAUD,EAChBnD,EAAMqD,WAAY,EAClBrD,EAAMsD,YAAa,EACnBtD,EAAMuD,QAAS,EACfvD,EAAMwD,QAAUvD,EACZD,EAAMyD,SACTzD,EAAMyD,OAAS,WACdzD,EAAMuD,QAAS,KAKlBzD,KAAK4D,aAAe,SAAS1D,EAAMC,GAC/BH,KAAKwC,WACPtC,EAAMwC,YACNxC,EAAMwC,SAASmB,GAAK7D,KAAKgB,SAAS,QAAQ6C,GAC1C3D,EAAMwC,SAASoB,YAAc9D,KAAKgB,SAAS,gBAExCb,GACFA,KAKHH,KAAK+D,cAAgB,SAASd,GAC7B,GAAID,GAAS,EACb,KAAI,GAAIgB,KAAYf,GACD,MAAfA,EAAIe,KACNhB,GAAUgB,EAAS,IAAIf,EAAIe,GAAU,IAKvC,OADAhB,GAASA,EAAOiB,MAAM,EAAEjB,EAAOV,OAAO,IAOvCtC,KAAKkE,UAAY,SAAShE,EAAMqB,GAC/B,GAAI4C,GAAO,EAERjE,GAAMkE,YACRD,EAAO,OACCjE,EAAMmE,cACdF,EAAO,SACCjE,EAAMoE,mBACdH,EAAO,cACCjE,EAAMqE,cACdJ,EAAO,QAELA,GAAM5C,IACE,QAAPA,EACFvB,KAAKgC,OAAO,wBACG,UAAPT,EACLvB,KAAKwC,WAAyC,oCAA9BxC,KAAKgB,SAAS,eAChChB,KAAKgC,OAAO,0BAEZhC,KAAKoD,MAAMlD,EAAM,SAEH,eAAPqB,EACLvB,KAAKwC,WAAyC,oCAA9BxC,KAAKgB,SAAS,eAChChB,KAAKgC,OAAO,+BAEZhC,KAAKoD,MAAMlD,EAAM,UAEVqB,EAAM,SACdvB,KAAKgC,OAAO,0BAQfhC,KAAKwE,eAAiB,SAASC,GAC9B,GAAIC,GAAM,GAAIC,QAAO,QAAUF,EAAO,gBAAiB,KAChDG,EAAIC,OAAO3C,SAAS4C,OAAOC,OAAO,GAAGC,MAAMN,EAC/C,OAAS,OAALE,EACOK,SAASL,EAAE,IAEf,SAOZzF,IAAIU,QAAQ,UAAU,QAAQ,OAAO,SAASC,EAAMC,GAEnDC,KAAKkF,OAAS,SAASC,EAAOhF,GAE7BiF,GAAGC,MAAM,WACRD,GAAGE,YAEFC,WAAY,cAAc,eAC1BhF,QAAS,SAASiF,GAEbA,EAAOC,YAAYC,aAAcF,EAAOC,YAAYE,aACvDvC,MAAM,wBAITgC,GAAGM,aACFE,KAAK,QACLrF,QAAQ,SAASsF,GAChB,GAAIC,IACHC,SAASF,EAAIE,SACbC,UAAUH,EAAIG,UAEfjG,GAAKU,WAAW,eAAeqF,GAC/B3F,EAAS2F,EAAaC,SAASD,EAAaE,YAE7CC,KAAK,WACJd,EAAOW,aAAe,aAQ1B9F,KAAKkG,SAAW,SAAShG,GACxB,GAAI8C,IACHmD,OAAM,EACNC,MAAQ,GACRC,UAAY,GACZC,SAAW,GACXC,UAAY,GACZhB,WAAa,cAAc,gBAExBlD,EAAMtC,EAAKK,WAAW,QAAQ,4BAC9BoG,EAAQ,OAAOC,mBAAmBvE,SAASC,KAC/CrC,GAAM4G,KAAKrE,EAAImE,GACdG,SACCC,eAAe,qDAEdrG,QAAQ,SAASC,GACnBwC,EAAOoD,MAAQ5F,EAAK4F,MACpBpD,EAAOqD,UAAY7F,EAAK6F,UACxBrD,EAAOsD,SAAW9F,EAAK8F,SACvBtD,EAAOuD,UAAY/F,EAAK+F,UACxBnB,GAAG9F,OAAO0D,KACRtC,MAAM,WACRX,EAAKqD,MAAMlD,EAAM,uBAKnBF,KAAK6G,iBAAmB,SAAS7D,GAChC,MAAqB,IAAlBA,EAAOqD,WAAiC,MAAlBrD,EAAOqD,WAAkC,IAAjBrD,EAAOsD,UAA+B,MAAjBtD,EAAOsD,UAAgC,IAAhBtD,EAAAA,YAAoC,MAAhBA,EAAAA,YAAuC,IAAjBA,EAAO8D,UAA+B,MAAjB9D,EAAO8D,UAAgC,IAAhB9D,EAAO+D,SAA6B,MAAhB/D,EAAO+D,SAQ/M/G,KAAKgH,MAAQ,SAASC,EAAQC,EAAKhH,GAClC,GAAI8C,IACHqD,UAAW,GACXC,SAAU,GACVa,UAAS,GACTL,SAAU,GACVC,QAAS,GACTxG,QAAQ,WACPR,EAAKiC,OAAO,kDAEb2B,OAAO,WACN5D,EAAKiC,OAAO,+CAEbiE,KAAK,WACJlG,EAAKiC,OAAO,+CAGd,IAAY,IAATiF,EAAqB,MAATA,EAAc,CAC5B,GAAInD,GAAc/D,EAAKiB,SAAS,eAC5BqB,EAAMtC,EAAKK,WAAW,QAAQ,mBAC9BoG,EAAQ,yBAAyBS,EAAQ,SAASC,CACtDpH,GAAM4G,KAAKrE,EAAImE,GACdG,SACCC,eAAe,kDACf9C,YAAcA,KAEbvD,QAAQ,SAASC,GACnBwC,EAAOqD,UAAY7F,EAAKA,KAAK4G,UAC7BpE,EAAOsD,SAAW9F,EAAKA,KAAK8F,SAC5BtD,EAAAA,WAAiBxC,EAAKA,KAALA,WACjBwC,EAAO8D,SAAW,MAClB9D,EAAO+D,QAAUvG,EAAKA,KAAK6G,KACN,IAAlBrE,EAAOqD,WAAiC,MAAlBrD,EAAOqD,WAAkC,IAAjBrD,EAAOsD,UAA+B,MAAjBtD,EAAOsD,UAAgC,IAAhBtD,EAAAA,YAAoC,MAAhBA,EAAAA,YAAuC,IAAjBA,EAAO8D,UAA+B,MAAjB9D,EAAO8D,UAAgC,IAAhB9D,EAAO+D,SAA6B,MAAhB/D,EAAO+D,SAC7M7G,EAAMoH,SAAU,EAChBvH,EAAKqD,MAAMlD,EAAM,qBAEjBA,EAAMoH,SAAU,EAChBlC,GAAGO,YAAY3C,MAEdtC,MAAM,WACRR,EAAMoH,SAAU,EAChBvH,EAAKqD,MAAMlD,EAAM,0BAUrBf,IAAIoI,UAAU,cAAe,WAC3B,GAAIC,IACFC,KAAM,SAAkBvH,EAAOwH,EAAUC,GACvCD,EAASE,KAAK,QAAS,WACrBxI,QAAQyI,QAAQ7H,MAAM8H,KAAK,MAAOH,EAAOH,gBAI9C,OAAOA,KAGVrI,IAAIoI,UAAU,iBAAkB,SAAUQ,GACtC,OACIC,SAAU,IACVP,KAAM,SAAUvH,EAAO2H,EAASC,GACxB5H,EAAM+H,SAAU,GAChBF,EAAS,WACL7H,EAAMgI,MAAM,0BAShC/I,IAAIU,QAAQ,UAAU,WACrBG,KAAKmI,eACJC,WAASjF,KAAI,EAAKU,GAAG,KAEtB7D,KAAKqI,YACJD,WAASjF,KAAI,EAAKmF,IAAI,IACtBC,QAAQpF,KAAI,EAAMmF,IAAI,OACtBE,SAASrF,KAAI,EAAMmF,IAAI,OACvBG,OAAOtF,KAAI,EAAMmF,IAAI,OACrBI,OAAOvF,KAAI,EAAMmF,IAAI,OACrBK,SAASxF,KAAI,EAAMmF,IAAI,QACvBM,UAAUzF,KAAI,EAAMmF,IAAI,OACxBO,SAAS1F,KAAI,EAAMmF,IAAI,QAExBtI,KAAK8I,YACJC,KAAK5F,KAAI,EAAKU,GAAG,IACjBmF,KAAK7F,KAAI,EAAMU,GAAG,IAClBoF,MAAM9F,KAAI,EAAMU,GAAG,IACnBqF,KAAK/F,KAAI,EAAMU,GAAG,IAClBsF,MAAMhG,KAAI,EAAMU,GAAG,IACnBuF,MAAMjG,KAAI,EAAMU,GAAG,IACnBwF,MAAMlG,KAAI,EAAMU,GAAG,IACnByF,WAAWnG,KAAI,EAAMU,GAAG,IACxB0F,OAAOpG,KAAI,EAAMU,GAAG,IACpB2F,MAAMrG,KAAI,EAAMU,GAAG,IACnB4F,MAAMtG,KAAI,EAAMU,GAAG,KAEpB7D,KAAK0J,eACJX,KAAK5F,KAAI,EAAKU,GAAG,IACjB8F,OAAOxG,KAAI,EAAMU,GAAG,GACpB+F,QAAQzG,KAAI,EAAMU,GAAG,GACrBgG,MAAM1G,KAAI,EAAMU,GAAG,GACnBiG,OAAO3G,KAAI,EAAMU,GAAG,IACpBkG,OAAO5G,KAAI,EAAMU,GAAG,IACpBmG,MAAM7G,KAAI,EAAMU,GAAG,IACnBoG,QAAQ9G,KAAI,EAAMU,GAAG,IACrBqG,SAAS/G,KAAI,EAAMU,GAAG,IACtBsG,QAAQhH,KAAI,EAAMU,GAAG,IACrB4F,MAAMtG,KAAI,EAAMU,GAAG,KAEpB7D,KAAKoK,WACJrB,KAAK5F,KAAI,EAAKU,GAAG,IACjBwG,SAASlH,KAAI,EAAMU,GAAG,IACtByG,SAASnH,KAAI,EAAMU,GAAG,KAEvB7D,KAAKuK,eACJxB,KAAK5F,KAAI,EAAKU,GAAG,IACjB2G,OAAOrH,KAAI,EAAMU,GAAG,IACpB4G,UAAUtH,KAAI,EAAMU,GAAG,IACvB6G,OAAOvH,KAAI,EAAMU,GAAG,IACpB8G,OAAOxH,KAAI,EAAMU,GAAG,IACpB+G,UAAUzH,KAAI,EAAMU,GAAG,IACvBgH,SAAS1H,KAAI,EAAMU,GAAG,IACtB4F,MAAMtG,KAAI,EAAMU,GAAG,KAEpB7D,KAAK8K,cACJ1C,WAASjF,KAAI,EAAKmF,IAAI,IACtByC,SAAS5H,KAAI,EAAMmF,IAAI,IACvB0C,UAAU7H,KAAI,EAAMmF,IAAI,IACxB2C,WAAW9H,KAAI,EAAMmF,IAAI,IACzB4C,SAAS/H,KAAI,EAAMmF,IAAI,IACvB6C,OAAOhI,KAAI,EAAMmF,IAAI,IACrB8C,SAASjI,KAAI,EAAMmF,IAAI,IACvB+C,UAAUlI,KAAI,EAAMmF,IAAI,IACxBgD,QAAQnI,KAAI,EAAMmF,IAAI,IACtBiD,SAASpI,KAAI,EAAMmF,IAAI,KAExBtI,KAAKwL,oBACJpD,WAASjF,KAAI,EAAKmF,IAAItI,KAAKmI,cAAcsD,MAAM,IAC/CC,MAAMvI,KAAI,EAAMmF,IAAItI,KAAK8I,WAAW2C,MAAM,KAC1CE,SAASxI,KAAI,EAAMmF,IAAItI,KAAK0J,cAAc+B,MAAM,KAChDG,KAAKzI,KAAI,EAAMmF,IAAItI,KAAKoK,UAAUqB,MAAM,KACxCI,SAAS1I,KAAI,EAAMmF,IAAItI,KAAKuK,cAAckB,MAAM,KAChDK,QAAQ3I,KAAI,EAAMmF,IAAItI,KAAK8K,aAAaW,MAAM","file":"module.js","sourcesContent":["var app = angular.module(\"myApp\",['ngRoute']);\r\n\r\n/*\r\n** 路由系统\r\n*/\r\napp.config([\"$routeProvider\",function($routeProvider){\r\n\t$routeProvider.when(\"/product\",{\r\n\t\ttemplateUrl:\"section/exam-product.html\",\r\n\t\tcontroller:\"examProductCtrl\"\r\n\t}).when(\"/hospital\",{\r\n\t\ttemplateUrl:\"section/exam-hospital.html\",\r\n\t\tcontroller:\"examHospitalCtrl\"\r\n\t}).otherwise({redirectTo:\"/product\"});\r\n}])\r\n\r\n/*\r\n** 数据访问类服务\r\n*/\r\napp.service(\"Ajax\",[\"$http\",\"Tool\",function($http,Tool){\r\n\tthis.loadHost = function(scope,callback){\r\n\t\tif(Tool.getSession(\"host\")){\r\n\t\t\tscope.host = Tool.getSession(\"host\");\r\n\t\t\tcallback();\r\n\t\t}else{\r\n\t\t\t$http.get(\"../contents/json/host.json\").success(function(data){\r\n\t\t\t\tvar host = data.host;\r\n\t\t\t\tscope.host = host;\r\n\t\t\t\tTool.setSession(\"host\",host);\r\n\t\t\t\tcallback();\r\n\t\t\t}).error(function(err){\r\n\t\t\t\tconsole.log(err);\r\n\t\t\t\tTool.setSession(\"host\",\"\");\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}]);\r\n\r\n/*\r\n**工具类服务\r\n*/\r\napp.service(\"Tool\",[\"$location\",function($location,Ajax){\r\n\t/*\r\n\t** 操作localStorage和sessionStorage\r\n\t*/\r\n\tthis.getLocal = function(key){\r\n\t\treturn JSON.parse(localStorage.getItem(key));\r\n\t};\r\n\tthis.setLocal = function(key,value){\r\n\t\tlocalStorage.setItem(key,JSON.stringify(value));\r\n\t};\r\n\tthis.removeLocal = function(key){\r\n\t\tlocalStorage.removeItem(key);\r\n\t};\r\n\tthis.clearLocal = function(){\r\n\t\tlocalStorage.clear();\r\n\t}\r\n\tthis.getSession = function(key){\r\n\t\treturn JSON.parse(sessionStorage.getItem(key));\r\n\t}\r\n\tthis.setSession = function(key,value){\r\n\t\tsessionStorage.setItem(key,JSON.stringify(value));\r\n\t}\r\n\tthis.removeSession = function(key){\r\n\t\tsessionStorage.removeItem(key);\r\n\t}\r\n\r\n\t/*\r\n\t** 跳转到下一页，不带host\r\n\t*/\r\n\tthis.goPage = function(path){\r\n\t\tif(this.getSession(\"host\")){\r\n\t\t\tlocation.href = this.getSession(\"host\")+path;\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n\t** 跳转到指定页面，带host\r\n\t*/\r\n\tthis.goUrl = function(url){\r\n\t\tif(url.length>0){\r\n\t\t\tlocation.href = url;\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n\t** 获取host\r\n\t*/\r\n\tthis.getHost = function(){\r\n\t\tvar host = \"\";\r\n\t\tif(this.getSession(\"host\")){\r\n\t\t\thost = this.getSession(\"host\");\r\n\t\t}\r\n\t\treturn host;\r\n\t}\r\n\tthis.isLogin = function(){\r\n\t\tif(this.getLocal(\"accessToken\")){\r\n\t\t\treturn true;\r\n\t\t}else{\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tthis.isUserInfoComplete = function(){\r\n\t\tvar userInfo = this.getLocal(\"user\");\r\n\t\tif(userInfo.realname==\"\"||userInfo.realname==null||userInfo.sex==\"\"||userInfo.sex==null||userInfo.age==\"\"||userInfo.age==null||userInfo.phone==\"\"||userInfo.phone==null){\r\n\t\t\treturn false;\r\n\t\t}else{\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\tthis.select = function(params,obj){\r\n\t\tfor(var proto in obj){\r\n\t\t\tif(proto==params){\r\n\t\t\t\tif(!obj[params].has){\r\n\t\t\t\t\tobj[params].has = true;\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tif(obj[proto].has){\r\n\t\t\t\t\tobj[proto].has = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t//确认按钮的提示框\r\n\tthis.alert = function(scope,mess,callback){\r\n\t\tscope.message = mess;\r\n\t\tscope.hasCancel = false;\r\n\t\tscope.hasComfirm = true;\r\n\t\tscope.hasTip = true;\r\n\t\tif(callback){\r\n\t\t\tscope.comfirm = callback;\r\n\t\t}else{\r\n\t\t\tscope.comfirm = function(){\r\n\t\t\t\tscope.hasTip = false;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t//确认和取消按钮的提示框\r\n\tthis.comfirm = function(scope,mess,callback){\r\n\t\tscope.message = mess;\r\n\t\tscope.hasCancel = true;\r\n\t\tscope.hasComfirm = true;\r\n\t\tscope.hasTip = true;\r\n\t\tscope.comfirm = callback;\r\n\t\tif(!scope.cancel){\r\n\t\t\tscope.cancel = function(){\r\n\t\t\t\tscope.hasTip = false;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t//获取用户信息\r\n\tthis.loadUserinfo = function(scope,callback){\r\n\t\tif(this.isLogin()){\r\n\t\t\tscope.userInfo = {};\r\n\t\t\tscope.userInfo.id = this.getLocal(\"user\").id;\r\n\t\t\tscope.userInfo.accessToken = this.getLocal(\"accessToken\");\r\n\t\t}else{\r\n\t\t\tif(callback){\r\n\t\t\t\tcallback();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t//将对象转换成查询字符串\r\n\tthis.convertParams = function(obj){\r\n\t\tvar params = \"\";\r\n\t\tfor(var property in obj){\r\n\t\t\tif(obj[property]!=null){\r\n\t\t\t\tparams += property+\"=\"+obj[property]+\"&\";\r\n\t\t\t}\r\n\t\t}\r\n\t\t//截取掉最后一个\"&\"\r\n\t\tparams = params.slice(0,params.length-1);\r\n\t\treturn params;\r\n\t}\r\n\r\n\t/*\r\n\t** 导航栏点击事件\r\n\t*/\r\n\tthis.menuClick = function(scope,value){\r\n\t\tvar page = \"\";\r\n\t\tvar url = \"\";\r\n\t\tif(scope.hasHomeMenu){\r\n\t\t\tpage = \"home\";\r\n\t\t}else if(scope.hasDoctorMenu){\r\n\t\t\tpage = \"doctor\";\r\n\t\t}else if(scope.hasInteractionMenu){\r\n\t\t\tpage = \"interaction\";\r\n\t\t}else if(scope.hasUserMenu){\r\n\t\t\tpage = \"user\"\r\n\t\t}\r\n\t\tif(page!=value){\r\n\t\t\tif(value==\"home\"){\r\n\t\t\t\tthis.goPage(\"/new/htmls/home.html\");\r\n\t\t\t}else if(value==\"doctor\"){\r\n\t\t\t\tif(this.isLogin()&&this.getLocal(\"accessToken\")==\"db284606729f481fb48d7bdbb373231b\"){\r\n\t\t\t\t\tthis.goPage(\"/new/htmls/doctor.html\");\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.alert(scope,\"敬请期待!\");\r\n\t\t\t\t}\r\n\t\t\t}else if(value==\"interaction\"){\r\n\t\t\t\tif(this.isLogin()&&this.getLocal(\"accessToken\")==\"db284606729f481fb48d7bdbb373231b\"){\r\n\t\t\t\t\tthis.goPage(\"/new/htmls/interaction.html\");\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.alert(scope,\"敬请期待!\");\r\n\t\t\t\t}\r\n\t\t\t}else if(value=\"user\"){\r\n\t\t\t\tthis.goPage(\"/new/htmls/user.html\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n\t** 获取url查询参数\r\n\t*/\r\n\tthis.getQueryString = function(name){\r\n\t\tvar reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)', 'i');\r\n\t    var r = window.location.search.substr(1).match(reg);\r\n\t    if (r != null) {\r\n\t        return unescape(r[2]);\r\n\t    }\r\n\t    return null;\r\n\t}\r\n}])\r\n\r\n/*\r\n** 微信支付服务\r\n*/\r\napp.service(\"Weixin\",[\"$http\",\"Tool\",function($http,Tool){\r\n\t//初始化完成后，检查客户端版本 --first--\r\n\tthis.wxInit = function($scope,callback){\r\n\t\t//wx初始化后检查客户端\r\n\t\twx.ready(function(){\r\n\t\t\twx.checkJsApi({\r\n\t\t\t\t//需要检测的JS接口列表\r\n\t\t\t\tjsApiList: ['getLocation','chooseWXPay'],\r\n\t\t\t\tsuccess: function(result) {\r\n\t\t\t\t\t//以键值对的形式返回，可用的api值true，不可用为false\r\n\t\t\t\t\tif(!result.checkResult.getLocation||!result.checkResult.chooseWXPay){\r\n\t\t\t\t\t\talert(\"客户端版本过低，请微信升级客户端!\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\twx.getLocation({\r\n\t\t\t\ttype:\"wgs84\",\r\n\t\t\t\tsuccess:function(res){\r\n\t\t\t\t\tvar locationInfo = {\r\n\t\t\t\t\t\tlatitude:res.latitude, //维度\r\n\t\t\t\t\t\tlongitude:res.longitude //经度\r\n\t\t\t\t\t}\r\n\t\t\t\t\tTool.setSession(\"locationInfo\",locationInfo);\r\n\t\t\t\t\tcallback(locationInfo.latitude,locationInfo.longitude);\r\n\t\t\t\t},\r\n\t\t\t\tfail:function(){\r\n\t\t\t\t\t$scope.locationInfo = \"定位失败\";\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t})\r\n\t}\r\n\r\n\t//初始化wx对象 --second--\r\n\tthis.wxConfig = function(scope){\r\n\t\tvar params = {\r\n\t\t\tdebug:false,\r\n\t\t\tappId : \"\",\r\n\t\t\ttimestamp : \"\",\r\n\t\t\tnonceStr : \"\",\r\n\t\t\tsignature : \"\",\r\n\t\t\tjsApiList : ['getLocation','chooseWXPay'],\r\n\t\t};\r\n\t\tvar url = Tool.getSession(\"host\")+\"/weixin/check/getjsconfig\";\r\n\t\tvar param = \"url=\"+encodeURIComponent(location.href);\r\n\t\t$http.post(url,param,{\r\n\t\t\theaders:{\r\n\t\t\t\t'Content-type':'application/x-www-form-urlencoded;charset=UTF-8',\r\n\t\t\t}\r\n\t\t}).success(function(data){\r\n\t\t\tparams.appId = data.appId;\r\n\t\t\tparams.timestamp = data.timestamp;\r\n\t\t\tparams.nonceStr = data.nonceStr;\r\n\t\t\tparams.signature = data.signature;\r\n\t\t\twx.config(params);\r\n\t\t}).error(function(){\r\n\t\t\tTool.alert(scope,\"初始化WX对象失败，请稍后再试！\");\r\n\t\t})\r\n\t}\r\n\r\n\t//检查微信支付的参数是否完整\r\n\tthis.wxCheckPayParams = function(params){\r\n\t\tif(params.timestamp==\"\"||params.timestamp==null||params.nonceStr==\"\"||params.nonceStr==null||params.package==\"\"||params.package==null||params.signType==\"\"||params.signType==null||params.paySign==\"\"||params.paySign==null){\r\n\t\t\treturn false;\r\n\t\t}else{\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\r\n\t//获取支付参数，并发起支付\r\n\tthis.wxPay = function(orderId,code,scope){\r\n\t\tvar params = {\r\n\t\t\ttimestamp: \"\",\r\n\t\t\tnonceStr: '',\r\n\t\t\tpackage: '',\r\n\t\t\tsignType: '',\r\n\t\t\tpaySign: '',\r\n\t\t\tsuccess:function() {\r\n\t\t\t\tTool.goPage(\"/new/htmls/pay-result.html#?payResult=success\");\r\n\t\t\t},\r\n\t\t\tcancel:function(){\r\n\t\t\t\tTool.goPage(\"/new/htmls/pay-result.html#?payResult=fail\");\r\n\t\t\t},\r\n\t\t\tfail:function(){\r\n\t\t\t\tTool.goPage(\"/new/htmls/pay-result.html#?payResult=fail\");\r\n\t\t\t}\r\n\t\t};\r\n\t\tif(orderId!=\"\"&orderId!=null){\r\n\t\t\tvar accessToken = Tool.getLocal(\"accessToken\");\r\n\t\t\tvar url = Tool.getSession(\"host\")+\"/wx/order/weixin\";\r\n\t\t\tvar param = \"payType=JSAPI&orderId=\"+orderId+\"&code=\"+code;\r\n\t\t\t$http.post(url,param,{\r\n\t\t\t\theaders:{\r\n\t\t\t\t\t'Content-type':'application/x-www-form-urlencoded;charset=UTF-8',\r\n\t\t\t\t\t'accessToken':accessToken,\r\n\t\t\t\t}\r\n\t\t\t}).success(function(data){\r\n\t\t\t\tparams.timestamp = data.data.timeStamp;\r\n\t\t\t\tparams.nonceStr = data.data.nonceStr;\r\n\t\t\t\tparams.package = data.data.package;\r\n\t\t\t\tparams.signType = \"MD5\";\r\n\t\t\t\tparams.paySign = data.data.sign;\r\n\t\t\t\tif(params.timestamp==\"\"||params.timestamp==null||params.nonceStr==\"\"||params.nonceStr==null||params.package==\"\"||params.package==null||params.signType==\"\"||params.signType==null||params.paySign==\"\"||params.paySign==null){\r\n\t\t\t\t\tscope.loading = false;\r\n\t\t\t\t\tTool.alert(scope,\"请求支付参数失败，请稍后再试!\");\r\n\t\t\t\t}else{\r\n\t\t\t\t\tscope.loading = false;\r\n\t\t\t\t\twx.chooseWXPay(params);\r\n\t\t\t\t}\r\n\t\t\t}).error(function(){\r\n\t\t\t\tscope.loading = false;\r\n\t\t\t\tTool.alert(scope,\"请求支付参数失败，请稍后再试!\");\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}])\r\n\r\n/*\r\n** ***指令类***\r\n*/\r\n//图片加载失败后，使用默认图片\r\napp.directive('fallbackSrc', function () {\r\n  var fallbackSrc = {\r\n    link: function postLink(scope, iElement, iAttrs) {\r\n      iElement.bind('error', function() {\r\n        angular.element(this).attr(\"src\", iAttrs.fallbackSrc);\r\n      });\r\n    }\r\n   }\r\n   return fallbackSrc;\r\n});\r\n//ng-repeat后触发事件\r\napp.directive('onFinishRender', function ($timeout) {\r\n    return {\r\n        restrict: 'A',\r\n        link: function (scope, element, attr) {\r\n            if (scope.$last === true) {\r\n                $timeout(function () {\r\n                    scope.$emit('ngRepeatFinished');\r\n                });\r\n            }\r\n        }\r\n}});\r\n\r\n/*\r\n** 存储菜单变量\r\n*/\r\napp.service(\"Params\",[function(){\r\n\tthis.defaultParams = {\r\n\t\tdefault:{has:true,id:\"\"}\r\n\t}\r\n\tthis.areaParams = {\r\n\t\tdefault:{has:true,val:\"\"},\r\n\t\tfutian:{has:false,val:\"福田区\"},\r\n\t\tnanshan:{has:false,val:\"南山区\"},\r\n\t\tluohu:{has:false,val:\"罗湖区\"},\r\n\t\tbaoan:{has:false,val:\"宝安区\"},\r\n\t\tlonghua:{has:false,val:\"龙华新区\"},\r\n\t\tlonggang:{has:false,val:\"龙岗区\"},\r\n\t\tyantian:{has:false,val:\"盐田区\"},\r\n\t}\r\n\tthis.yakeParams = {\r\n\t\tall:{has:true,id:\"\"},\r\n\t\tzzy:{has:false,id:19},\r\n\t\txiya:{has:false,id:20},\r\n\t\tkcy:{has:false,id:82},\r\n\t\tbuya:{has:false,id:22},\r\n\t\tbaya:{has:false,id:23},\r\n\t\tycmr:{has:false,id:24},\r\n\t\tjiaozheng:{has:false,id:64},\r\n\t\tyichi:{has:false,id:65},\r\n\t\tyzzl:{has:false,id:63},\r\n\t\tqita:{has:false,id:60},\r\n\t};\r\n\tthis.meirongParams = {\r\n\t\tall:{has:true,id:\"\"},\r\n\t\tyanbu:{has:false,id:7},\r\n\t\tmianbu:{has:false,id:8},\r\n\t\tbibu:{has:false,id:9},\r\n\t\txiong:{has:false,id:45},\r\n\t\txizhi:{has:false,id:12},\r\n\t\tsimi:{has:false,id:78},\r\n\t\tzhushe:{has:false,id:79},\r\n\t\tjiguang:{has:false,id:80},\r\n\t\tkoucun:{has:false,id:81},\r\n\t\tqita:{has:false,id:13},\r\n\t};\r\n\tthis.fckParams = {\r\n\t\tall:{has:true,id:\"\"},\r\n\t\tjiancha:{has:false,id:48},\r\n\t\tfenmian:{has:false,id:49}\r\n\t};\r\n\tthis.zhongyiParams = {\r\n\t\tall:{has:true,id:\"\"},\r\n\t\ttoubu:{has:false,id:51},\r\n\t\tjianjing:{has:false,id:52},\r\n\t\tyaobu:{has:false,id:53},\r\n\t\ttuibu:{has:false,id:54},\r\n\t\tquanshen:{has:false,id:55},\r\n\t\tjingluo:{has:false,id:56},\r\n\t\tqita:{has:false,id:57}\r\n\t}\r\n\tthis.tijianParams = {\r\n\t\tdefault:{has:true,val:\"\"},\r\n\t\tshangye:{has:false,val:75},\r\n\t\tchanggui:{has:false,val:67},\r\n\t\tzhongnian:{has:false,val:69},\r\n\t\tlaonian:{has:false,val:70},\r\n\t\truzhi:{has:false,val:71},\r\n\t\tyunqian:{has:false,val:72},\r\n\t\tqingnian:{has:false,val:68},\r\n\t\tertong:{has:false,val:74},\r\n\t\tmanbing:{has:false,val:73},\r\n\t}\r\n\tthis.professionalParams = {\r\n\t\tdefault:{has:true,val:this.defaultParams,proId:\"\"},\r\n\t\tyake:{has:false,val:this.yakeParams,proId:\"2\"},\r\n\t\tmeirong:{has:false,val:this.meirongParams,proId:\"3\"},\r\n\t\tfck:{has:false,val:this.fckParams,proId:\"4\"},\r\n\t\tzhongyi:{has:false,val:this.zhongyiParams,proId:\"6\"},\r\n\t\ttijian:{has:false,val:this.tijianParams,proId:\"5\"}\r\n\t}\r\n}])\r\n"],"sourceRoot":"/source/"}