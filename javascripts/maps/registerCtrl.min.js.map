{"version":3,"sources":["registerCtrl.min.js"],"names":["app","controller","$scope","$http","$interval","Tool","Ajax","phone","password","passwordAgian","code","codeText","codeState","disable","phoneCheckResult","init","loadHost","register","check","codeCheck","registering","test","length","alert","getCode","url","host","data","post","headers","Content-type","success","time","interval","then","cancel","message","error","phoneCheck","callback","goPage"],"mappings":"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","file":"registerCtrl.min.js","sourcesContent":["app.controller(\"registerCtrl\",[\"$scope\",\"$http\",\"$interval\",\"Tool\",\"Ajax\",function($scope,$http,$interval,Tool,Ajax){\r\n\t$scope.phone=\"\"; //手机号码\r\n\t$scope.password=\"\"; //密码\r\n\t$scope.passwordAgian=\"\"; //确认密码\r\n\t$scope.code=\"\"; //验证码\r\n\t$scope.codeText=\"获取短信验证码\";\r\n\t$scope.codeState = true; //验证码按钮是否可用\r\n\t$scope.disable = false;\r\n\t$scope.phoneCheckResult = false;\r\n\r\n\t/**\r\n\t * 加载host\r\n\t */\r\n\t$scope.init = function(){\r\n\t\tAjax.loadHost($scope,function(){})\r\n\t}\r\n\r\n\t/*\r\n\t** 注册按钮处理函数\r\n\t*/\r\n\t$scope.register = function(){\r\n\t\tif($scope.check()){\r\n\t\t\t$scope.codeCheck($scope.registering);\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n\t** 检查输入是否符合要求\r\n\t*/\r\n\t$scope.check = function(){\r\n\t\tif(/^1[3|4|5|7|8]\\d{9}$/.test($scope.phone)&&$scope.password.length>=8&&$scope.password.length<=20&$scope.password==$scope.passwordAgian){\r\n\t\t\treturn true;\r\n\t\t}else{\r\n\t\t\tif(!(/^1[3|4|5|7|8]\\d{9}$/.test($scope.phone))){\r\n\t\t\t\tTool.alert($scope,\"手机号码错误，请仔细检查!\");\r\n\t\t\t\treturn false;\r\n\t\t\t}else if($scope.password.length<8|$scope.password.length>20){\r\n\t\t\t\tTool.alert($scope,\"密码长度不符合要求，请输入8-20位的密码!\");\r\n\t\t\t\treturn false;\r\n\t\t\t}else if($scope.password!=$scope.passwordAgian){\r\n\t\t\t\tTool.alert($scope,\"两次输入的密码不一致，请重新输入!\");\r\n\t\t\t\treturn false;\r\n\t\t\t}else{\r\n\t\t\t\tTool.alert($scope,\"手机号码或者密码错误，请重新输入!\");\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n\t** 验证码按钮处理函数\r\n\t*/\r\n\t$scope.getCode = function(){\r\n\t\tif($scope.codeState){\r\n\t\t\tif($scope.phoneCheckResult){\r\n\t\t\t\t/*\r\n\t\t\t\t** 发送短信验证码\r\n\t\t\t\t*/\r\n\t\t\t\tvar url = $scope.host+\"/wx/register/sendsmsregistercode\";\r\n\t\t\t\tvar data = \"phone=\"+$scope.phone;\r\n\t\t\t\t$http.post(url,data,{\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t   'Content-type':'application/x-www-form-urlencoded;charset=UTF-8',\r\n\t\t\t\t\t }\r\n\t\t\t\t}).success(function(data){\r\n\t\t\t\t\tif(data.code==0){\r\n\t\t\t\t\t\tvar time = 59;\r\n\t\t\t\t\t\t$scope.codeState = false;\r\n\t\t\t\t\t\tvar interval = $interval(function(){\r\n\t\t\t\t\t\t\t$scope.codeText = (time+\" S\");\r\n\t\t\t\t\t\t\ttime--;\r\n\t\t\t\t\t\t},1000,60).then(function(){\r\n\t\t\t\t\t\t\t$scope.codeText = \"获取短信验证码\";\r\n\t\t\t\t\t\t\t$scope.codeState = true;\r\n\t\t\t\t\t\t\t$interval.cancel(interval);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tTool.alert($scope,data.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t}).error(function(){\r\n\t\t\t\t\tTool.alert($scope,\"发送验证码失败，请稍后再试!\");\r\n\t\t\t\t})\r\n\t\t\t}else{\r\n\t\t\t\tTool.alert($scope,\"请填写正确手机号码!\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n\t** 检查手机号码是否可以注册\r\n\t*/\r\n\t$scope.phoneCheck = function(){\r\n\t\tif(/^1[3|4|5|7|8]\\d{9}$/.test($scope.phone)){\r\n\t\t\tvar url = $scope.host+\"/wx/register/registercheck\";\r\n\t\t\tvar data = \"name=phone&param=\"+$scope.phone;\r\n\t\t\t$http.post(url,data,{\r\n\t\t\t\theaders: {\r\n\t\t\t\t   'Content-type':'application/x-www-form-urlencoded;charset=UTF-8',\r\n\t\t\t\t }\r\n\t\t\t}).success(function(data){\r\n\t\t\t\tif(data.code==0){\r\n\t\t\t\t\t$scope.phoneCheckResult = true;\r\n\t\t\t\t}else{\r\n\t\t\t\t\tTool.alert($scope,data.message);\r\n\t\t\t\t}\r\n\t\t\t}).error(function(){\r\n\t\t\t\tTool.alert($scope,\"手机号码检查失败，请稍后再试!\");\r\n\t\t\t})\r\n\t\t}else{\r\n\t\t\tTool.alert($scope,\"手机号码不正确！\");\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n\t** 验证短信验证码是否正确\r\n\t*/\r\n\t$scope.codeCheck = function(callback){\r\n\t\tvar url = $scope.host+\"/wx/register/registercheck\";\r\n\t\tvar data = \"name=verifyCode&param=\"+$scope.code+\"&p=\"+$scope.phone;\r\n\t\t$http.post(url,data,{\r\n\t\t\theaders: {\r\n\t\t\t   'Content-type':'application/x-www-form-urlencoded;charset=UTF-8',\r\n\t\t\t }\r\n\t\t}).success(function(data){\r\n\t\t\tif(data.code==0){\r\n\t\t\t\tcallback();\r\n\t\t\t}else{\r\n\t\t\t\tTool.alert($scope,data.message);\r\n\t\t\t}\r\n\t\t}).error(function(){\r\n\t\t\tTool.alert($scope,\"验证码验证失败，请重试!\");\r\n\t\t})\r\n\t}\r\n\r\n\t/*\r\n\t** 注册\r\n\t*/\r\n\t$scope.registering = function(){\r\n\t\tvar url = $scope.host + \"/wx/register/register\";\r\n\t\tvar data = \"phone=\"+$scope.phone+\"&verifyCode=\"+$scope.code+\"&password=\"+$scope.password;\r\n\t\t$http.post(url,data,{\r\n\t\t\theaders: {\r\n\t\t\t   'Content-type':'application/x-www-form-urlencoded;charset=UTF-8',\r\n\t\t\t }\r\n\t\t}).success(function(data){\r\n\t\t\tif(data.code==0){\r\n\t\t\t\tTool.alert($scope,\"注册成功!\",function(){\r\n\t\t\t\t\tTool.goPage(\"/new/htmls/login.html\");\r\n\t\t\t\t})\r\n\t\t\t}else{\r\n\t\t\t\tTool.alert(data.message);\r\n\t\t\t}\r\n\t\t}).error(function(){\r\n\t\t\t//失败\r\n\t\t\treturn false;\r\n\t\t})\r\n\t}\r\n}])\r\n"],"sourceRoot":"/source/"}