{"version":3,"sources":["newsCtrl.js"],"names":["app","controller","$scope","$http","Tool","Ajax","news","navValue","currentPage","pageRows","loading","noProduct","noProductText","navParam","all","has","val","yake","meirong","fck","zhongyi","window","onscroll","body","document","html","documentElement","height","Math","max","scrollHeight","offsetHeight","clientHeight","innerHeight","scrollY","loadNext","init","loadHost","loadNews","type","select","url","getSession","params","post","headers","Content-type","success","data","code","length","mergeImg","concat","alert","message","error","items","forEach","item","picture","detail","id","goPage","$location","search","loadDetail","host"],"mappings":"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","file":"newsCtrl.js","sourcesContent":["app.controller(\"newsCtrl\",[\"$scope\",\"$http\",\"Tool\",\"Ajax\",function($scope,$http,Tool,Ajax){\r\n\t$scope.news = [];\r\n\t$scope.navValue = \"all\";\r\n\t$scope.currentPage = 1;\r\n\t$scope.pageRows = 10;\r\n\t$scope.loading = false;\r\n\t$scope.noProduct = false;\r\n\t$scope.noProductText = \"\";\r\n\t$scope.navParam = {\r\n\t\t\"all\":{\r\n\t\t\thas:true,\r\n\t\t\tval:\"综合\"\r\n\t\t},\r\n\t\t\"yake\":{\r\n\t\t\thas:false,\r\n\t\t\tval:\"牙科\"\r\n\t\t},\r\n\t\t\"meirong\":{\r\n\t\t\thas:false,\r\n\t\t\tval:\"美容\"\r\n\t\t},\r\n\t\t\"fck\":{\r\n\t\t\thas:false,\r\n\t\t\tval:\"妇产科\"\r\n\t\t},\r\n\t\t\"zhongyi\":{\r\n\t\t\thas:false,\r\n\t\t\tval:\"中医理疗\"\r\n\t\t},\r\n\t}\r\n\r\n\t//滚动监听\r\n\twindow.onscroll = function(){\r\n\t\tif($scope.loading||$scope.noProduct){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar body = document.body;\r\n\t    var html = document.documentElement;\r\n\t\tvar height = Math.max( body.scrollHeight, body.offsetHeight,html.clientHeight, html.scrollHeight, html.offsetHeight );\r\n\t\tif(height>window.innerHeight){\r\n\t\t\tif (height - window.scrollY - window.innerHeight < 100) {\r\n\t\t\t\t$scope.loadNext();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t$scope.init = function(){\r\n\t\tAjax.loadHost($scope,function(){\r\n\t\t\t$scope.loadNews();\r\n\t\t});\r\n\t}\r\n\r\n\t/*\r\n\t** 切换导航栏\r\n\t*/\r\n\t$scope.switch = function(type){\r\n\t\tif(type!=$scope.navValue){\r\n\t\t\t$scope.navValue = type;\r\n\t\t\tTool.select(type,$scope.navParam);\r\n\t\t\t$scope.news = [];\r\n\t\t\t$scope.currentPage = 1;\r\n\t\t\t$scope.noProduct = false;\r\n\t\t\t$scope.loadNews();\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n\t** 查询数据\r\n\t*/\r\n\t$scope.loadNews = function(){\r\n\t\t$scope.loading = true;\r\n\t\tvar url = Tool.getSession(\"host\")+\"/wx/health/queryByType\";\r\n\t\tvar params = \"type=\"+$scope.navParam[$scope.navValue].val+\"&currentPage=\"+$scope.currentPage+\"&pageRows=\"+$scope.pageRows;\r\n\t\t$http.post(url,params,{\r\n\t\t\theaders: {\r\n\t\t\t   'Content-type':'application/x-www-form-urlencoded;charset=UTF-8',\r\n\t\t\t }\r\n\t\t}).success(function(data){\r\n\t\t\tif(data.code==0){\r\n\t\t\t\tif(data.data.length<1){\r\n\t\t\t\t\tif($scope.news.length<1){\r\n\t\t\t\t\t\t$scope.noProductText = \"暂时没有资讯信息!\";\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t$scope.noProductText = \"已经没有项目了!\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$scope.noProduct = true;\r\n\t\t\t\t}else{\r\n\t\t\t\t\t$scope.mergeImg(data.data);\r\n\t\t\t\t\t$scope.news = $scope.news.concat(data.data);\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tTool.alert($scope,data.message);\r\n\t\t\t}\r\n\t\t\t$scope.loading = false;\r\n\t\t}).error(function(){\r\n\t\t\t$scope.loading = false;\r\n\t\t\t$scope.noProduct = true;\r\n\t\t\tTool.alert(\"查询数据失败，请稍后再试!\");\r\n\t\t})\r\n\t}\r\n\r\n\t/*\r\n\t** 分页查询，查询下一页\r\n\t*/\r\n\t$scope.loadNext = function(){\r\n\t\t$scope.currentPage++;\r\n\t\t$scope.loadNews();\r\n\t}\r\n\r\n\t/*\r\n\t** 图片为空时，设置默认图片\r\n\t*/\r\n\t$scope.mergeImg = function(items){\r\n\t\titems.forEach(function(item){\r\n\t\t\tif(item.picture==\"\"||item.picture == null){\r\n\t\t\t\titem.picture = \"../contents/img/p_default.png\";\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t/*\r\n\t** 跳转到详细页面\r\n\t*/\r\n\t$scope.detail = function(id){\r\n\t\tTool.goPage(\"/new/htmls/news-detail.html#?id=\"+id);\r\n\t}\r\n}])\r\n\r\napp.controller(\"newsDetailCtrl\",[\"$scope\",\"$http\",\"$location\",\"Tool\",\"Ajax\",function($scope,$http,$location,Tool,Ajax){\r\n\t$scope.loading= false;\r\n\t$scope.detail = {};\r\n\t$scope.id = null;\r\n\r\n\t$scope.init = function(){\r\n\t\tAjax.loadHost($scope,function(){\r\n\t\t\t$scope.id = $location.search().id;\r\n\t\t\t$scope.loadDetail();\r\n\t\t})\r\n\t}\r\n\r\n\t$scope.loadDetail = function(){\r\n\t\t$scope.loading = true;\r\n\t\tvar url = $scope.host+\"/wx/health/querydetail\";\r\n\t\tvar params = \"id=\"+$scope.id;\r\n\t\t$http.post(url,params,{\r\n\t\t\theaders: {\r\n\t\t\t   'Content-type':'application/x-www-form-urlencoded;charset=UTF-8',\r\n\t\t\t }\r\n\t\t}).success(function(data){\r\n\t\t\tif(data.code==0){\r\n\t\t\t\t$scope.detail = data.data;\r\n\t\t\t}else{\r\n\t\t\t\tTool.alert($scope,\"查询数据失败，请稍后再试!\");\r\n\t\t\t}\r\n\t\t\t$scope.loading= false;\r\n\t\t}).error(function(){\r\n\t\t\t$scope.loading= false;\r\n\t\t\tTool.alert($scope,\"查询数据失败，请稍后再试!\");\r\n\t\t})\r\n\t}\r\n}])\r\n"],"sourceRoot":"/source/"}