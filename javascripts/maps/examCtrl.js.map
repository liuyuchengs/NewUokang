{"version":3,"sources":["examCtrl.js"],"names":["app","controller","$scope","$http","Tool","proSelect","selectValue","item","loading","noProduct","hasBg","noProductText","products","queryParams","city","area","professionId","itemId","order","specialty","currentPage","pageRows","hasOrder","hasArea","hasClass","hasSex","menuParams","classes","sex","orderParams","default","has","val","price","priceDesc","scoreDesc","countDesc","areaParams","futian","nanshan","luohu","baoan","longhua","longgang","yantian","classParams","shangye","changgui","zhongnian","laonian","ruzhi","yunqian","qingnian","ertong","manbing","sexParams","men","women","switchMenu","menu","areaSelect","params","select","loadProduct","orderSelect","classSelect","sexSelect","load","window","onscroll","body","document","html","documentElement","height","Math","max","scrollHeight","offsetHeight","clientHeight","innerHeight","scrollY","loadNext","url","getSession","convertParams","post","headers","Content-type","success","data","length","mergeProdcut","concat","error","alert","items","forEach","priceunit","preferPriceType","pricetype","detail","proId","hosId","goPage","hospitals","loadHospital","list","merge","score","logo"],"mappings":"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","file":"examCtrl.js","sourcesContent":["app.controller(\"examCtrl\",[\"$scope\",\"$http\",\"Tool\",function($scope,$http,Tool){\r\n\t$scope.proSelect = true;\r\n\t$scope.selectValue = \"product\";\r\n\r\n\t$scope.switch = function(item){\r\n\t\tif(item!=$scope.selectValue){\r\n\t\t\tif(item==\"product\"){\r\n\t\t\t\t$scope.proSelect = true;\r\n\t\t\t\t$scope.selectValue = \"product\";\r\n\t\t\t}else{\r\n\t\t\t\t$scope.proSelect = false;\r\n\t\t\t\t$scope.selectValue = \"hospital\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}])\r\n\r\napp.controller(\"examProductCtrl\",[\"$scope\",\"$http\",\"Tool\",function($scope,$http,Tool){\r\n\t$scope.loading = false;\r\n\t$scope.noProduct = false;\r\n\t$scope.hasBg = false;\r\n\t$scope.noProductText=\"\";\r\n\t$scope.products = [];\r\n\r\n\t$scope.queryParams = {\r\n\t\tcity:\"深圳\",\r\n\t\tarea:\"\",\r\n\t\tprofessionId:5,\r\n\t\titemId:\"\",\r\n\t\torder:\"\",\r\n\t\tspecialty:\"\",\r\n\t\tcurrentPage:0,\r\n\t\tpageRows:10,\r\n\t}\r\n\r\n\t//菜单切换变量\r\n\t$scope.hasOrder = false;\r\n\t$scope.hasArea = false;\r\n\t$scope.hasClass = false;\r\n\t$scope.hasSex = false;\r\n\t//菜单项变量\r\n\t$scope.menuParams = {\r\n\t\tarea:false,\r\n\t\torder:false,\r\n\t\tclasses:false,\r\n\t\tsex:false,\r\n\t}\r\n\r\n\t$scope.orderParams = {\r\n\t\tdefault:{has:true,val:\"\"},\r\n\t\tprice:{has:false,val:\"prefer_price asc\"},\r\n\t\tpriceDesc:{has:false,val:\"prefer_price desc\"},\r\n\t\tscoreDesc:{has:false,val:\"hospital_score asc\"},\r\n\t\tcountDesc:{has:false,val:\"sales desc\"}\r\n\t}\r\n\t$scope.areaParams = {\r\n\t\tdefault:{has:true,val:\"\"},\r\n\t\tfutian:{has:false,val:\"福田区\"},\r\n\t\tnanshan:{has:false,val:\"南山区\"},\r\n\t\tluohu:{has:false,val:\"罗湖区\"},\r\n\t\tbaoan:{has:false,val:\"宝安区\"},\r\n\t\tlonghua:{has:false,val:\"龙华新区\"},\r\n\t\tlonggang:{has:false,val:\"龙岗区\"},\r\n\t\tyantian:{has:false,val:\"盐田\"},\r\n\t}\r\n\t$scope.classParams = {\r\n\t\tdefault:{has:true,val:\"\"},\r\n\t\tshangye:{has:false,val:75},\r\n\t\tchanggui:{has:false,val:67},\r\n\t\tzhongnian:{has:false,val:69},\r\n\t\tlaonian:{has:false,val:70},\r\n\t\truzhi:{has:false,val:71},\r\n\t\tyunqian:{has:false,val:72},\r\n\t\tqingnian:{has:false,val:68},\r\n\t\tertong:{has:false,val:74},\r\n\t\tmanbing:{has:false,val:73},\r\n\t}\r\n\t$scope.sexParams = {\r\n\t\tdefault:{has:true,val:\"通用\"},\r\n\t\tmen:{has:false,val:\"男\"},\r\n\t\twomen:{has:false,val:\"女\"},\r\n\t}\r\n\r\n\t/*\r\n\t** 下拉菜单切换\r\n\t*/\r\n\t$scope.switchMenu =function(menu){\r\n\t\tswitch(menu){\r\n\t\t\tcase \"area\":\r\n\t\t\t\tif($scope.hasOrder){\r\n\t\t\t\t\t$scope.hasOrder = false;\r\n\t\t\t\t\t$scope.menuParams.order = false;\r\n\t\t\t\t};\r\n\t\t\t\tif($scope.hasClass){\r\n\t\t\t\t\t$scope.hasClass = false;\r\n\t\t\t\t\t$scope.menuParams.classes = false;\r\n\t\t\t\t};\r\n\t\t\t\tif($scope.hasSex){\r\n\t\t\t\t\t$scope.hasSex = false;\r\n\t\t\t\t\t$scope.menuParams.sex = false;\r\n\t\t\t\t}\r\n\t\t\t\t$scope.hasArea = !$scope.hasArea;\r\n\t\t\t\tif($scope.hasArea){\r\n\t\t\t\t\t$scope.menuParams.area = true;\r\n\t\t\t\t}else{\r\n\t\t\t\t\t$scope.menuParams.area = false;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"order\":\r\n\t\t\t\tif($scope.hasArea){\r\n\t\t\t\t\t$scope.hasArea = false;\r\n\t\t\t\t\t$scope.menuParams.area = false;\r\n\t\t\t\t};\r\n\t\t\t\tif($scope.hasClass){\r\n\t\t\t\t\t$scope.hasClass = false;\r\n\t\t\t\t\t$scope.menuParams.classes = false;\r\n\t\t\t\t};\r\n\t\t\t\tif($scope.hasSex){\r\n\t\t\t\t\t$scope.hasSex = false;\r\n\t\t\t\t\t$scope.menuParams.sex = false;\r\n\t\t\t\t}\r\n\t\t\t\t$scope.hasOrder = !$scope.hasOrder;\r\n\t\t\t\tif($scope.hasOrder){\r\n\t\t\t\t\t$scope.menuParams.order = true;\r\n\t\t\t\t}else{\r\n\t\t\t\t\t$scope.menuParams.order = false;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"class\":\r\n\t\t\t\tif($scope.hasOrder){\r\n\t\t\t\t\t$scope.hasOrder = false;\r\n\t\t\t\t\t$scope.menuParams.order = false;\r\n\t\t\t\t};\r\n\t\t\t\tif($scope.hasArea){\r\n\t\t\t\t\t$scope.hasArea = false;\r\n\t\t\t\t\t$scope.menuParams.area = false;\r\n\t\t\t\t};\r\n\t\t\t\tif($scope.hasSex){\r\n\t\t\t\t\t$scope.hasSex = false;\r\n\t\t\t\t\t$scope.menuParams.sex = false;\r\n\t\t\t\t}\r\n\t\t\t\t$scope.hasClass = !$scope.hasClass;\r\n\t\t\t\tif($scope.hasClass){\r\n\t\t\t\t\t$scope.menuParams.classes = true;\r\n\t\t\t\t}else{\r\n\t\t\t\t\t$scope.menuParams.classes = false;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"sex\":\r\n\t\t\t\tif($scope.hasOrder){\r\n\t\t\t\t\t$scope.hasOrder = false;\r\n\t\t\t\t\t$scope.menuParams.order = false;\r\n\t\t\t\t};\r\n\t\t\t\tif($scope.hasArea){\r\n\t\t\t\t\t$scope.hasArea = false;\r\n\t\t\t\t\t$scope.menuParams.area = false;\r\n\t\t\t\t};\r\n\t\t\t\tif($scope.hasClass){\r\n\t\t\t\t\t$scope.hasClass = false;\r\n\t\t\t\t\t$scope.menuParams.classes = false;\r\n\t\t\t\t};\r\n\t\t\t\t$scope.hasSex = !$scope.hasSex;\r\n\t\t\t\tif($scope.hasSex){\r\n\t\t\t\t\t$scope.menuParams.sex = true;\r\n\t\t\t\t}else{\r\n\t\t\t\t\t$scope.menuParams.sex = false;\r\n\t\t\t\t}\r\n\t\t}\r\n\t\tif($scope.hasOrder||$scope.hasArea||$scope.hasClass||$scope.hasSex){\r\n\t\t\t$scope.hasBg = true;\r\n\t\t}else{\r\n\t\t\t$scope.hasBg = false;\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n\t** 区域下拉菜单项点击\r\n\t*/\r\n\t$scope.areaSelect =function(params){\r\n\t\tTool.select(params,$scope.areaParams);\r\n\t\t$scope.queryParams.area = $scope.areaParams[params].val;\r\n\t\t$scope.queryParams.currentPage = 0;\r\n\t\t$scope.products = [];\r\n\t\t$scope.noProduct = false;\r\n\t\t$scope.loadProduct();\r\n\t\t$scope.switchMenu(\"area\");\r\n\t}\r\n\r\n\t/*\r\n\t** 排序下拉菜单项点击\r\n\t*/\r\n\t$scope.orderSelect = function(params){\r\n\t\tTool.select(params,$scope.orderParams);\r\n\t\t$scope.queryParams.order = $scope.orderParams[params].val;\r\n\t\t$scope.queryParams.currentPage = 0;\r\n\t\t$scope.products = [];\r\n\t\t$scope.noProduct = false;\r\n\t\t$scope.loadProduct();\r\n\t\t$scope.switchMenu(\"order\");\r\n\t}\r\n\r\n\t/*\r\n\t** 类别下拉菜单项点击\r\n\t*/\r\n\t$scope.classSelect = function(params){\r\n\t\tTool.select(params,$scope.classParams);\r\n\t\t$scope.queryParams.itemId = $scope.classParams[params].val;\r\n\t\t$scope.queryParams.currentPage = 0;\r\n\t\t$scope.products = [];\r\n\t\t$scope.noProduct = false;\r\n\t\t$scope.loadProduct();\r\n\t\t$scope.switchMenu(\"class\");\r\n\t}\r\n\r\n\t/*\r\n\t** 性别下拉菜单项点击\r\n\t*/\r\n\t$scope.sexSelect = function(params){\r\n\t\tTool.select(params,$scope.sexParams);\r\n\t\t$scope.queryParams.specialty = $scope.sexParams[params].val;\r\n\t\t$scope.queryParams.currentPage = 0;\r\n\t\t$scope.products = [];\r\n\t\t$scope.noProduct = false;\r\n\t\t$scope.loadProduct();\r\n\t\t$scope.switchMenu(\"sex\");\r\n\t}\r\n\r\n\r\n\t/*\r\n\t** 初始化\r\n\t*/\r\n\t$scope.load = function(){\r\n\t\t$scope.loadProduct();\r\n\t}\r\n\r\n\t/*\r\n\t** 滚动监听\r\n\t*/\r\n\twindow.onscroll = function(){\r\n\t\tif($scope.loading||$scope.noProduct){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar body = document.body;\r\n\t    var html = document.documentElement;\r\n\t\tvar height = Math.max( body.scrollHeight, body.offsetHeight,html.clientHeight, html.scrollHeight, html.offsetHeight );\r\n\t\tif(height>window.innerHeight){\r\n\t\t\tif (height - window.scrollY - window.innerHeight < 100) {\r\n\t\t\t\t$scope.loadNext();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n\t** 加载体检项目\r\n\t*/\r\n\t$scope.loadProduct = function(){\r\n\t\t$scope.loading = true;\r\n\t\tvar url = Tool.getSession(\"host\")+\"/wx/product/querylist\";\r\n\t\tvar params = Tool.convertParams($scope.queryParams);\r\n\t\t$http.post(url,params,{\r\n\t\t\theaders:{\r\n\t\t\t\t'Content-type':'application/x-www-form-urlencoded;charset=UTF-8',\r\n\t\t\t}\r\n\t\t}).success(function(data){\r\n\t\t\tif(data.length<1){\r\n\t\t\t\tif($scope.products.length<1){\r\n\t\t\t\t\t$scope.noProductText = \"没有项目信息,请选择其他区域或者时间!\";\r\n\t\t\t\t}else{\r\n\t\t\t\t\t$scope.noProductText = \"已经没有项目了!\";\r\n\t\t\t\t}\r\n\t\t\t\t$scope.noProduct = true;\r\n\t\t\t}else{\r\n\t\t\t\t$scope.mergeProdcut(data);\r\n\t\t\t\t$scope.products = $scope.products.concat(data);\r\n\t\t\t}\r\n\t\t\t$scope.loading=false;\r\n\t\t}).error(function(){\r\n\t\t\t$scope.loading=false;\r\n\t\t\t$scope.noProduct = true;\r\n\t\t\tTool.alert($scope,\"查询数据失败，请稍后再试！\");\r\n\t\t})\r\n\t}\r\n\r\n\t/*\r\n\t** 合并价格单位,如：元/次\r\n\t*/\r\n\t$scope.mergeProdcut = function(items){\r\n\t\titems.forEach(function(item){\r\n\t\t\tif(item.priceunit!=null&&item.priceunit!=\"\"){\r\n\t\t\t\titem.preferPriceType = item.pricetype+\"/\"+item.priceunit;\r\n\t\t\t}else{\r\n\t\t\t\titem.preferPriceType = item.pricetype;\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t/*\r\n\t** 跳转到套餐详细页面\r\n\t*/\r\n\t$scope.detail = function(proId,hosId){\r\n\t\tTool.goPage(\"/new/htmls/exam-detail.html#?productId=\"+proId+\"&hospitalId=\"+hosId);\r\n\t}\r\n\r\n\t/*\r\n\t** 加载下一页数据\r\n\t*/\r\n\t$scope.loadNext = function(){\r\n\t\t$scope.queryParams.currentPage++;\r\n\t\t$scope.loadProduct();\r\n\t}\r\n\r\n}])\r\n\r\napp.controller(\"examHospitalCtrl\",[\"$scope\",\"$http\",\"Tool\",function($scope,$http,Tool){\r\n\t$scope.queryParams = {\r\n\t\tcity:\"深圳\",\r\n\t\tarea:null,\r\n\t\tprofessionId:5,\r\n\t\torder:null,\r\n\t\tcurrentPage:0,\r\n\t\tpageRows:10,\r\n\t}\r\n\t$scope.loading = false;\r\n\t$scope.noProduct = false;\r\n\t$scope.noProductText = \"\";\r\n\t$scope.hospitals = [];\r\n\r\n\t/*\r\n\t** 初始化页面\r\n\t*/\r\n\t$scope.load = function(){\r\n\t\t$scope.loadHospital();\r\n\t}\r\n\r\n\t$scope.loadHospital = function(){\r\n\t\t$scope.loading = true;\r\n\t\tvar url = Tool.getSession(\"host\")+\"/wx/hospital/querylist\";\r\n\t\tvar params = Tool.convertParams($scope.queryParams);\r\n\t\t$http.post(url,params,{\r\n\t\t\theaders:{\r\n\t\t\t\t'Content-type':'application/x-www-form-urlencoded;charset=UTF-8',\r\n\t\t\t}\r\n\t\t}).success(function(data){\r\n\t\t\tif(data.list.length>0){\r\n\t\t\t\t$scope.merge(data.list);\r\n\t\t\t\t$scope.hospitals = $scope.hospitals.concat(data.list);\r\n\t\t\t}else{\r\n\t\t\t\tif($scope.hospitals.length<1){\r\n\t\t\t\t\t$scope.noProductText = \"没有项目信息,请选择其他区域或者时间!\";\r\n\t\t\t\t}else{\r\n\t\t\t\t\t$scope.noProductText = \"已经没有项目了!\";\r\n\t\t\t\t}\r\n\t\t\t\t$scope.noProduct = true;\r\n\t\t\t}\r\n\t\t\t$scope.loading = false;\r\n\t\t}).error(function(){\r\n\t\t\t$scope.loading = false;\r\n\t\t\tTool.alert(\"加载数据失败，请稍后再试!\");\r\n\t\t})\r\n\t}\r\n\r\n\t/*\r\n\t** 得分为空是显示字符串\r\n\t*/\r\n\t$scope.merge = function(items){\r\n\t\titems.forEach(function(item){\r\n\t\t\tif(item.score==\"\"||item.score==null){\r\n\t\t\t\titem.score = \"暂无评分\";\r\n\t\t\t}\r\n\t\t\tif(item.logo==\"\"||item.logo==null){\r\n\t\t\t\titem.logo = \"../../contents/img/p_default.png\"\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t/*\r\n\t** 加载下一页数据\r\n\t*/\r\n\t$scope.loadNext = function(){\r\n\t\t$scope.queryParams.currentPage++;\r\n\t\t$scope.loadProduct();\r\n\t}\r\n}])\r\n"],"sourceRoot":"/source/"}