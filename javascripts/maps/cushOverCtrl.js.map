{"version":3,"sources":["cushOverCtrl.js"],"names":["app","controller","$scope","$http","Tool","Ajax","userId","accessToken","cushs","noCushOver","init","loadHost","loadUserinfo","loadCushOver","url","host","params","userInfo","id","post","headers","Content-type","success","data","code","length","merge","alert","error","items","forEach","item","index","array","state","mess"],"mappings":"AAAAA,IAAIC,WAAW,gBAAgB,SAAS,QAAQ,OAAO,OAAO,SAASC,EAAOC,EAAMC,EAAKC,GACxFH,EAAOI,OACPJ,EAAOK,YACPL,EAAOM,MACPN,EAAOO,YAAa,EAKpBP,EAAOQ,KAAO,WACbL,EAAKM,SAAST,EAAO,WACpBE,EAAKQ,aAAaV,GAClBA,EAAOW,kBAKTX,EAAOW,aAAe,WACrB,GAAIC,GAAMZ,EAAOa,KAAK,oBAClBC,EAAS,UAAUd,EAAOe,SAASC,EACvCf,GAAMgB,KAAKL,EAAIE,GACdI,SACGC,eAAe,kDACfd,YAAcL,EAAOe,SAASV,eAE/Be,QAAQ,SAASC,GACL,GAAXA,EAAKC,KACJD,EAAKA,KAAKE,OAAO,EACnBvB,EAAOO,YAAa,GAEpBP,EAAOwB,MAAMH,EAAKA,MAClBrB,EAAOM,MAAQe,EAAKA,MAGrBnB,EAAKuB,MAAMzB,EAAO,mBAEjB0B,MAAM,WACRxB,EAAKuB,MAAMzB,EAAO,oBAIpBA,EAAOwB,MAAQ,SAASG,GACvBA,EAAMC,QAAQ,SAASC,EAAKC,EAAMC,GAClB,GAAZF,EAAKG,MACPH,EAAKI,KAAK,MACU,GAAZJ,EAAKG,QACbH,EAAKI,KAAK","file":"cushOverCtrl.js","sourcesContent":["app.controller(\"cushOverCtrl\",[\"$scope\",\"$http\",\"Tool\",\"Ajax\",function($scope,$http,Tool,Ajax){\r\n\t$scope.userId;\r\n\t$scope.accessToken;\r\n\t$scope.cushs;\r\n\t$scope.noCushOver = false;\r\n\r\n\t/*\r\n\t** 初始化页面\r\n\t*/\r\n\t$scope.init = function(){\r\n\t\tAjax.loadHost($scope,function(){\r\n\t\t\tTool.loadUserinfo($scope);\r\n\t\t\t$scope.loadCushOver();\r\n\t\t})\r\n\t}\r\n\r\n\t//加载过期代金券信息\r\n\t$scope.loadCushOver = function(){\r\n\t\tvar url = $scope.host+\"/wx/order/overdue\";\r\n\t\tvar params = \"userId=\"+$scope.userInfo.id;\r\n\t\t$http.post(url,params,{\r\n\t\t\theaders: {\r\n\t\t\t   'Content-type':'application/x-www-form-urlencoded;charset=UTF-8',\r\n\t\t\t   'accessToken':$scope.userInfo.accessToken\r\n\t\t\t }\r\n\t\t}).success(function(data){\r\n\t\t\tif(data.code==0){\r\n\t\t\t\tif(data.data.length<1){\r\n\t\t\t\t\t$scope.noCushOver = true;\r\n\t\t\t\t}else{\r\n\t\t\t\t\t$scope.merge(data.data);\r\n\t\t\t\t\t$scope.cushs = data.data;\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tTool.alert($scope,\"数据加载失败，请稍后再试!\");\r\n\t\t\t}\r\n\t\t}).error(function(){\r\n\t\t\tTool.alert($scope,\"数据加载失败，请稍后再试!\");\r\n\t\t})\r\n\t}\r\n\t//判断代金券是过期还是已使用\r\n\t$scope.merge = function(items){\r\n\t\titems.forEach(function(item,index,array){\r\n\t\t\tif(item.state==1){\r\n\t\t\t\titem.mess=\"已使用\";\r\n\t\t\t}else if(item.state==3){\r\n\t\t\t\titem.mess=\"已过期\";\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n}])\r\n"],"sourceRoot":"/source/"}