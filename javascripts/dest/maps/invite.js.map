{"version":3,"sources":["invite.js"],"names":["define","$scope","$rootScope","$location","Tool","Ajax","Weixin","bgStyle","width","window","screen","height","bodyStyle","min-height","shareObj","title","desc","link","imgUrl","success","showTip","alert","cancel","ready","code","inviteInit","noWindowListen","search","at","accessToken","queryCode","checkLogin","loadUserinfo","userInfo","wxInit","wxConfig","hasTip","changeRoute","post","url","host","params","then","data","referralCode","nickname","loading","queryShare","id","content","image","switchTip","item","share","wxShare","registerInit","name","goRegister","angular","element","document","path"],"mappings":"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","file":"invite.js","sourcesContent":["define(function(){\r\n    return function($scope,$rootScope,$location,Tool,Ajax,Weixin){\r\n        //定义样式\r\n        $scope.bgStyle = {\r\n            \"width\":window.screen.width,\r\n            \"height\":(window.screen.width/320)*145,\r\n        }\r\n        $scope.bodyStyle = {\r\n            \"width\":window.screen.width,\r\n            \"min-height\":window.screen.height-50,\r\n        }\r\n        $scope.shareObj = {\r\n\t\t\ttitle:\"悠康医生邀请好友即送现金啦\",\r\n\t\t\tdesc:\"悠康医生邀请好友即可获得现金和代金券，快来看看吧!\",\r\n\t\t\tlink:\"https://www.uokang.com/v2/htmls/index.html#/invite/register\",\r\n\t\t\timgUrl:\"https://www.uokang.com/new/contents/img/logo.png\",\r\n\t\t\tsuccess:function(){\r\n\t\t\t\t$scope.showTip = false;\r\n                Tool.alert(\"分享成功!\");\r\n\t\t\t},\r\n\t\t\tcancel:function(){},\r\n            ready:false,//是否配置完成\r\n\t\t}\r\n        $scope.code = \"\";\r\n        $scope.showTip = false;\r\n\r\n        //邀请好友初始化\r\n        $scope.inviteInit = function(){\r\n            Tool.noWindowListen();\r\n            if($location.search().at){\r\n                var accessToken = $location.search().at;\r\n                $scope.queryCode(accessToken);\r\n            }else{\r\n                if(Tool.checkLogin()){\r\n                    Tool.loadUserinfo();\r\n                    $scope.queryCode(Tool.userInfo.accessToken);\r\n                    //$scope.queryShare();\r\n                    Weixin.wxInit($scope);\r\n                    Weixin.wxConfig($scope);\r\n                }else{\r\n                    Tool.alert(\"请先登录\",function(){\r\n                        $rootScope.hasTip = false;\r\n                        Tool.changeRoute(\"/user\");\r\n                    })\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        //查询用户的邀请码\r\n        $scope.queryCode = function(accessToken){\r\n            Ajax.post({\r\n                url:Tool.host+\"/wx/user/createReferralCode\",\r\n                params:{\"accessToken\":accessToken},\r\n            }).then(function(data){\r\n                if(data.code==0){\r\n                    $scope.code = data.data.referralCode;\r\n                    $scope.shareObj.link = $scope.shareObj.link+\"?code=\"+$scope.code+\"&name=\"+Tool.userInfo.nickname;\r\n                    $scope.shareObj.ready = true;\r\n                    //$scope.queryShare();\r\n                }else{\r\n                    Tool.alert(\"查询邀请码错误!\");\r\n                }\r\n            }).catch(function(){\r\n                Tool.alert(\"查询邀请码失败!\");\r\n            }).finally(function(){\r\n                $rootScope.loading = false;\r\n            })\r\n        }\r\n\r\n        //查询分享内容\r\n        $scope.queryShare = function(){\r\n            Ajax.post({\r\n                url:Tool.host+\"/wx/share/queryById\",\r\n                params:{id:98}\r\n            }).then(function(data){\r\n                if(data.code==0){\r\n                    $scope.shareObj.title= data.data.title;\r\n                    $scope.shareObj.desc = data.data.content;\r\n                    $scope.shareObj.link = data.data.url+\"?code=\"+$scope.code+\"&name=\"+Tool.userInfo.nickname;\r\n                    $scope.shareObj.imgUrl = data.data.image;\r\n                    $scope.shareObj.ready = true;\r\n                }else{\r\n                    Tool.alert(\"获取分享内容失败，请稍后再试！\");\r\n                    $scope.shareObj.ready = false;\r\n                }\r\n            }).catch(function(){\r\n                Tool.alert(\"获取分享内容失败，请稍后再试！\");\r\n            }).finally(function(){\r\n                $rootScope.loading = false;\r\n            })\r\n        }\r\n\r\n        //切换提示框\r\n        $scope.switchTip = function(item){\r\n            if(item===\"close\"){\r\n                $scope.showTip = false;\r\n            }\r\n            if(item===\"open\"){\r\n                $scope.showTip = true;\r\n            }  \r\n        }\r\n\r\n        //分享邀请按钮\r\n        $scope.share = function(){\r\n            if($scope.shareObj.ready){\r\n                $scope.switchTip(\"open\");\r\n                Weixin.wxShare($scope.shareObj);\r\n            }else{\r\n                Tool.alert(\"获取分享内容失败，请稍后再试！\");\r\n            }\r\n        }\r\n\r\n        //新用户注册初始化\r\n        $scope.registerInit = function(){\r\n            if($location.search().code){\r\n                $scope.code = $location.search().code;\r\n                $scope.name = $location.search().name;\r\n            }else{\r\n                Tool.alert(\"请检查链接是否完整\",function(){\r\n                    $rootScope.hasTip = false;\r\n                    Tool.changeRoute(\"/home\");\r\n                })\r\n            }\r\n        }\r\n\r\n        //跳转注册\r\n        $scope.goRegister = function(){\r\n            Tool.changeRoute(\"/register\",\"code=\"+$scope.code);\r\n        }\r\n\r\n        //页面初始化\r\n        angular.element(document).ready(function(){\r\n            if($location.path()){\r\n                var path = $location.path();\r\n                if(path===\"/invite/new\"){\r\n                    $scope.inviteInit();\r\n                }else if(path===\"/invite/register\"){\r\n                    $scope.registerInit();\r\n                }\r\n            }else{\r\n                Tool.changeRoute(\"/home\");\r\n            }\r\n        })\r\n    }\r\n})"],"sourceRoot":"/source/"}