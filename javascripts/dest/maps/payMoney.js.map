{"version":3,"sources":["payMoney.js"],"names":["define","$scope","$rootScope","Tool","Ajax","showPay","money","dealMoney","balance","init","hasBgColor","noWindowListen","checkLogin","loadUserinfo","queryMoney","changeRoute","choosePay","alert","hiddenPay","post","url","host","params","accessToken","userInfo","then","data","code","message","loading","getMoney","flag","$event","stopPropagation","checkAccount","hasTip","alipay","wxpay"],"mappings":"AAAAA,OAAO,WACH,MAAO,UAASC,OAAOC,WAAWC,KAAKC,MACnCH,OAAOI,SAAU,EACjBJ,OAAOK,OACHC,UAAU,KACVC,QAAQ,MAEZP,OAAOQ,KAAO,WACVP,WAAWQ,YAAa,GAI5BT,OAAOQ,KAAO,WACVP,WAAWQ,YAAa,EACxBP,KAAKQ,iBACFR,KAAKS,cACJT,KAAKU,eACLZ,OAAOa,cAEPX,KAAKY,YAAY,UAKzBd,OAAOe,UAAY,WACZf,OAAOK,MAAME,QAAQ,EACpBP,OAAOI,SAAU,EAEjBF,KAAKc,MAAM,aAMnBhB,OAAOiB,UAAY,WACfjB,OAAOI,SAAU,GAIrBJ,OAAOa,WAAa,WAChBV,KAAKe,MACDC,IAAIjB,KAAKkB,KAAK,uBACdC,QAAQC,YAAcpB,KAAKqB,SAASD,eACrCE,KAAK,SAASC,MACC,GAAXA,KAAKC,KACJ1B,OAAOK,MAAQoB,KAAKA,KAEpBvB,KAAKc,MAAMS,KAAKE,WAPxBxB,SASS,WACLD,KAAKc,MAAM,mBAVfb,WAWW,WACPF,WAAW2B,SAAU,KAK7B5B,OAAO6B,SAAW,SAASC,KAAKC,QAC5BA,OAAOC,kBACJhC,OAAOiC,aAAaH,MACnB3B,KAAKe,MACDC,IAAIjB,KAAKkB,KAAK,qBACdC,QAAQC,YAAcpB,KAAKqB,SAASD,YAAYQ,KAAOA,QACxDN,KAAK,SAASC,MACC,GAAXA,KAAKC,OACJ1B,OAAOI,SAAU,EACjBJ,OAAOa,gBANfV,SAQS,WACLD,KAAKc,MAAM,iBATfb,WAUW,WACPF,WAAW2B,SAAS,IAGxB1B,KAAKc,MAAM,iBAAiB,WACxBf,WAAWiC,QAAS,EACpBhC,KAAKY,YAAY,qBAO7Bd,OAAOiC,aAAe,SAASH,MAC3B,MAAS,IAANA,MAA+B,MAAtB5B,KAAKqB,SAASY,QAAoC,IAAtBjC,KAAKqB,SAASY,QAGvC,GAANL,MAA8B,MAArB5B,KAAKqB,SAASa,OAAkC,IAArBlC,KAAKqB,SAASa","file":"payMoney.js","sourcesContent":["define(function(){\r\n    return function($scope,$rootScope,Tool,Ajax){\r\n        $scope.showPay = false;\r\n        $scope.money = {\r\n            dealMoney:null,\r\n            balance:null,\r\n        }\r\n        $scope.init = function(){\r\n            $rootScope.hasBgColor = false;\r\n        }\r\n\r\n        //页面初始化\r\n        $scope.init = function(){\r\n            $rootScope.hasBgColor = false;\r\n            Tool.noWindowListen();\r\n            if(Tool.checkLogin()){\r\n                Tool.loadUserinfo();\r\n                $scope.queryMoney();\r\n            }else{\r\n                Tool.changeRoute(\"/user\");\r\n            }\r\n        }\r\n\r\n        //显示支付\r\n        $scope.choosePay = function(){\r\n            if($scope.money.balance>0){\r\n                $scope.showPay = true;\r\n            }else{\r\n                Tool.alert(\"没有可提取余额!\");\r\n            }\r\n            \r\n        }\r\n\r\n        //隐藏支付\r\n        $scope.hiddenPay = function(){\r\n            $scope.showPay = false;\r\n        }\r\n\r\n        //查询提现金额\r\n        $scope.queryMoney = function(){\r\n            Ajax.post({\r\n                url:Tool.host+\"/wx/withDraw/myMoney\",\r\n                params:{\"accessToken\":Tool.userInfo.accessToken},\r\n            }).then(function(data){\r\n                if(data.code==0){\r\n                    $scope.money = data.data;\r\n                }else{\r\n                    Tool.alert(data.message);\r\n                }\r\n            }).catch(function(){\r\n                Tool.alert(\"获取信息失败，请稍后再试!\");\r\n            }).finally(function(){\r\n                $rootScope.loading = false;\r\n            })\r\n        }\r\n\r\n        //申请提现\r\n        $scope.getMoney = function(flag,$event){\r\n            $event.stopPropagation();\r\n            if($scope.checkAccount(flag)){\r\n                Ajax.post({\r\n                    url:Tool.host+\"/wx/withDraw/apply\",\r\n                    params:{\"accessToken\":Tool.userInfo.accessToken,\"flag\":flag}\r\n                }).then(function(data){\r\n                    if(data.code==0){\r\n                        $scope.showPay = false;\r\n                        $scope.queryMoney();\r\n                    }\r\n                }).catch(function(){\r\n                    Tool.alert(\"提取失败，请稍后再试!\");\r\n                }).finally(function(){\r\n                    $rootScope.loading =false;\r\n                })\r\n            }else{\r\n                Tool.alert(\"请先绑定微信或者支付宝账号!\",function(){\r\n                    $rootScope.hasTip = false;\r\n                    Tool.changeRoute(\"/user/userinfo\");\r\n                })\r\n            }\r\n            \r\n        }\r\n\r\n        //检查是否有绑定账号\r\n        $scope.checkAccount = function(flag){\r\n            if(flag==1&&Tool.userInfo.alipay!=null&&Tool.userInfo.alipay!=\"\"){\r\n                return true;\r\n\r\n            }else if(flag==2&&Tool.userInfo.wxpay!=null&&Tool.userInfo.wxpay!=\"\"){\r\n                return true;\r\n            }else{\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n})"],"sourceRoot":"/source/"}