{"version":3,"sources":["cushOver.js"],"names":["define","$scope","$rootScope","Tool","Ajax","userId","accessToken","cushs","noCushOver","init","hasBgColor","noWindowListen","checkLogin","loadUserinfo","loadCushOver","changeRoute","post","url","host","params","userInfo","id","headers","then","data","code","length","merge","alert","loading","items","forEach","item","index","array","state","mess"],"mappings":"AAAAA,OAAO,WACN,MAAO,UAASC,OAAOC,WAAWC,KAAKC,MACtCH,OAAOI,OACPJ,OAAOK,YACPL,OAAOM,MACPN,OAAOO,YAAa,EAGpBP,OAAOQ,KAAO,WACbP,WAAWQ,YAAa,EACxBP,KAAKQ,iBACFR,KAAKS,cACPT,KAAKU,eACLZ,OAAOa,gBAEPX,KAAKY,YAAY,UAKnBd,OAAOa,aAAe,WACrBV,KAAKY,MACJC,IAAId,KAAKe,KAAK,oBACdC,QAAQd,OAAOF,KAAKiB,SAASC,IAC7BC,SACChB,YAAcH,KAAKiB,SAASd,eAE3BiB,KAAK,SAASC,MACF,GAAXA,KAAKC,KACJD,KAAKA,KAAKE,OAAO,EACnBzB,OAAOO,YAAa,GAEpBP,OAAO0B,MAAMH,KAAKA,MAClBvB,OAAOM,MAAQiB,KAAKA,MAGrBrB,KAAKyB,MAAM,mBAfbxB,SAiBS,WACRD,KAAKyB,MAAM,mBAlBZxB,WAmBW,WACVF,WAAW2B,SAAU,KAKvB5B,OAAO0B,MAAQ,SAASG,OACvBA,MAAMC,QAAQ,SAASC,KAAKC,MAAMC,OAClB,GAAZF,KAAKG,MACPH,KAAKI,KAAK,MACU,GAAZJ,KAAKG,QACbH,KAAKI,KAAK","file":"cushOver.js","sourcesContent":["define(function(){\r\n\treturn function($scope,$rootScope,Tool,Ajax){\r\n\t\t$scope.userId;\r\n\t\t$scope.accessToken;\r\n\t\t$scope.cushs;\r\n\t\t$scope.noCushOver = false;\r\n\r\n\t\t// 初始化页面\r\n\t\t$scope.init = function(){\r\n\t\t\t$rootScope.hasBgColor = true;\r\n\t\t\tTool.noWindowListen();\r\n\t\t\tif(Tool.checkLogin()){\r\n\t\t\t\tTool.loadUserinfo();\r\n\t\t\t\t$scope.loadCushOver();\r\n\t\t\t}else{\r\n\t\t\t\tTool.changeRoute(\"/user\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// 加载过期代金券信息\r\n\t\t$scope.loadCushOver = function(){\r\n\t\t\tAjax.post({\r\n\t\t\t\turl:Tool.host+\"/wx/order/overdue\",\r\n\t\t\t\tparams:{userId:Tool.userInfo.id},\r\n\t\t\t\theaders:{\r\n\t\t\t\t\t'accessToken':Tool.userInfo.accessToken\r\n\t\t\t\t}\r\n\t\t\t}).then(function(data){\r\n\t\t\t\tif(data.code==0){\r\n\t\t\t\t\tif(data.data.length<1){\r\n\t\t\t\t\t\t$scope.noCushOver = true;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t$scope.merge(data.data);\r\n\t\t\t\t\t\t$scope.cushs = data.data;\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\tTool.alert(\"数据加载失败，请稍后再试!\");\r\n\t\t\t\t}\r\n\t\t\t}).catch(function(){\r\n\t\t\t\tTool.alert(\"数据加载失败，请稍后再试!\");\r\n\t\t\t}).finally(function(){\r\n\t\t\t\t$rootScope.loading = false;\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\t// 判断代金券是过期还是已使用\r\n\t\t$scope.merge = function(items){\r\n\t\t\titems.forEach(function(item,index,array){\r\n\t\t\t\tif(item.state==1){\r\n\t\t\t\t\titem.mess=\"已使用\";\r\n\t\t\t\t}else if(item.state==3){\r\n\t\t\t\t\titem.mess=\"已过期\";\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n})\r\n"],"sourceRoot":"/source/"}