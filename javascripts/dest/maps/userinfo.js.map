{"version":3,"sources":["userinfo.js"],"names":["define","$scope","$rootScope","Tool","Ajax","phone","realname","sex","age","nickname","email","init","hasBgColor","noWindowListen","checkLogin","loadUserinfo","post","url","host","params","headers","accessToken","userInfo","then","data","setLocal","user","face","wxpay","alipay","alert","loading","changeRoute","exit","clearLocal","change","item","state"],"mappings":"AAAAA,OAAO,WACN,MAAO,UAASC,OAAOC,WAAWC,KAAKC,MACtCH,OAAOI,MACPJ,OAAOK,SACPL,OAAOM,IACPN,OAAOO,IACPP,OAAOQ,SACPR,OAAOS,MAGPT,OAAOU,KAAO,WACbT,WAAWU,YAAa,EACxBT,KAAKU,iBACFV,KAAKW,cACPX,KAAKY,eACLX,KAAKY,MACJC,IAAId,KAAKe,KAAK,6BACdC,OAAO,KACPC,SACCC,YAAclB,KAAKmB,SAASD,eAE3BE,KAAK,SAASC,MAChBrB,KAAKsB,SAAS,OAAOD,KAAKA,KAC1B,IAAIE,MAAOF,KAAKA,IAChBvB,QAAOI,MAAQqB,KAAKrB,OAAS,GAC7BJ,OAAOK,SAAWoB,KAAKpB,UAAY,GACnCL,OAAOM,IAAMmB,KAAKnB,KAAO,GACzBN,OAAOO,IAAMkB,KAAKlB,KAAO,GACzBP,OAAOQ,SAAWiB,KAAKjB,UAAY,GACnCR,OAAOS,MAAQ,GACfT,OAAO0B,KAAOD,KAAKC,KACnB1B,OAAO2B,MAAQF,KAAKE,MACpB3B,OAAO4B,OAASH,KAAKG,SAjBtBzB,SAkBS,WACRD,KAAK2B,MAAM,qBAnBZ1B,WAoBW,WACVF,WAAW6B,SAAU,KAGtB5B,KAAK6B,YAAY,UAKnB/B,OAAOgC,KAAO,WACb9B,KAAK+B,aACL/B,KAAK6B,YAAY,UAIlB/B,OAAOkC,OAAS,SAASC,MACxB,GAAIC,MACM,WAAPD,MAEDC,MADwB,OAAtBlC,KAAKmB,SAASM,OAAoC,KAAtBzB,KAAKmB,SAASM,MACpC,EAEA,EAETzB,KAAK6B,YAAY,uBAAuB,QAAQI,KAAK,UAAUC,QAChD,WAAPD,MAEPC,MADyB,OAAvBlC,KAAKmB,SAASO,QAAsC,KAAvB1B,KAAKmB,SAASO,OACrC,EAED,EAER1B,KAAK6B,YAAY,uBAAuB,QAAQI,KAAK,UAAUC,QAE/DlC,KAAK6B,YAAY,uBAAuB,QAAQI","file":"userinfo.js","sourcesContent":["define(function(){\r\n\treturn function($scope,$rootScope,Tool,Ajax){\r\n\t\t$scope.phone;\r\n\t\t$scope.realname;\r\n\t\t$scope.sex;\r\n\t\t$scope.age;\r\n\t\t$scope.nickname;\r\n\t\t$scope.email;\r\n\r\n\t\t//页面初始化\r\n\t\t$scope.init = function(){\r\n\t\t\t$rootScope.hasBgColor = true;\r\n\t\t\tTool.noWindowListen();\r\n\t\t\tif(Tool.checkLogin()){\r\n\t\t\t\tTool.loadUserinfo();\r\n\t\t\t\tAjax.post({\r\n\t\t\t\t\turl:Tool.host+\"/wx/mycount/getUserByToken\",\r\n\t\t\t\t\tparams:null,\r\n\t\t\t\t\theaders:{\r\n\t\t\t\t\t\t\"accessToken\":Tool.userInfo.accessToken\r\n\t\t\t\t\t}\r\n\t\t\t\t}).then(function(data){\r\n\t\t\t\t\tTool.setLocal(\"user\",data.data);\r\n\t\t\t\t\tvar user = data.data;\r\n\t\t\t\t\t$scope.phone = user.phone || \"\";\r\n\t\t\t\t\t$scope.realname = user.realname || \"\";\r\n\t\t\t\t\t$scope.sex = user.sex || \"\";\r\n\t\t\t\t\t$scope.age = user.age || \"\";\r\n\t\t\t\t\t$scope.nickname = user.nickname || \"\";\r\n\t\t\t\t\t$scope.email = \"\";\r\n\t\t\t\t\t$scope.face = user.face;\r\n\t\t\t\t\t$scope.wxpay = user.wxpay;\r\n\t\t\t\t\t$scope.alipay = user.alipay;\r\n\t\t\t\t}).catch(function(){\r\n\t\t\t\t\tTool.alert(\"获取用户信息失败，请稍后再试!\");\r\n\t\t\t\t}).finally(function(){\r\n\t\t\t\t\t$rootScope.loading = false;\r\n\t\t\t\t})\t\r\n\t\t\t}else{\r\n\t\t\t\tTool.changeRoute(\"/user\");\r\n\t\t\t}\t\r\n\t\t}\r\n\r\n\t\t// 退出登录\r\n\t\t$scope.exit = function(){\r\n\t\t\tTool.clearLocal();\r\n\t\t\tTool.changeRoute(\"/user\");\r\n\t\t}\r\n\r\n\t\t// 跳转到修改账户信息页面\r\n\t\t$scope.change = function(item){\r\n\t\t\tvar state;\r\n\t\t\tif(item===\"wxpay\"){\r\n\t\t\t\tif(Tool.userInfo.wxpay===null||Tool.userInfo.wxpay===\"\"){\r\n\t\t\t\t\tstate = 2;\r\n\t\t\t\t}else{\r\n\t\t\t\t\tstate = 1;\r\n\t\t\t\t}\r\n\t\t\t\tTool.changeRoute(\"/user/userinfochange\",\"item=\"+item+\"&state=\"+state);\r\n\t\t\t}else if(item===\"alipay\"){\r\n\t\t\t\tif(Tool.userInfo.alipay===null||Tool.userInfo.alipay===\"\"){\r\n\t\t\t\t\tstate = 2;\r\n\t\t\t\t}else{\r\n\t\t\t\t\tstate =1;\r\n\t\t\t\t}\r\n\t\t\t\tTool.changeRoute(\"/user/userinfochange\",\"item=\"+item+\"&state=\"+state);\r\n\t\t\t}else{\r\n\t\t\t\tTool.changeRoute(\"/user/userinfochange\",\"item=\"+item);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n})\r\n"],"sourceRoot":"/source/"}