{"version":3,"sources":["service.js"],"names":["define","app","wx","service","$rootScope","$http","$q","Tool","this","get","obj","url","loading","defered","defer","headers","success","data","resolve","error","reject","promise","post","Content-type","params","convertParams","$location","host","userInfo","getLocal","key","JSON","parse","localStorage","getItem","setLocal","value","setItem","stringify","removeLocal","removeItem","clearLocal","clear","getSession","sessionStorage","setSession","removeSession","goUrl","length","location","href","changeRoute","path","search","checkLogin","isUserInfoComplete","realname","sex","age","phone","select","proto","has","alert","mess","callback","message","hasCancel","hasComfirm","hasTip","comfirm","cancel","loadUserinfo","property","slice","noWindowListen","window","onscroll","Ajax","wxInit","$scope","ready","checkJsApi","jsApiList","result","checkResult","getLocation","chooseWXPay","type","res","locationInfo","latitude","longitude","fail","wxConfig","scope","debug","appId","timestamp","nonceStr","signature","encodeURIComponent","then","config","wxShare","onMenuShareTimeline","title","link","imgUrl","onMenuShareAppMessage","desc","dataUrl","onMenuShareQQ","onMenuShareQZone","onMenuShareWeibo","wxCheckPayParams","signType","paySign","wxPay","orderId","code","package","accessToken","timeStamp","sign","defaultParams","default","id","areaParams","val","futian","nanshan","luohu","baoan","longhua","longgang","yantian","yakeParams","all","zzy","xiya","kcy","buya","baya","ycmr","jiaozheng","yichi","yzzl","qita","meirongParams","yanbu","mianbu","bibu","xiong","xizhi","simi","zhushe","jiguang","koucun","fckParams","jiancha","fenmian","zhongyiParams","toubu","jianjing","yaobu","tuibu","quanshen","jingluo","tijianParams","shangye","changgui","zhongnian","laonian","ruzhi","yunqian","qingnian","ertong","manbing","professionalParams","proId","yake","meirong","fck","zhongyi","tijian"],"mappings":"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","file":"service.js","sourcesContent":["define([\"app\",\"wx\"],function(app,wx){\r\n\r\n    // 数据访问服务\r\n    app.service(\"Ajax\",[\"$rootScope\",\"$http\",\"$q\",\"Tool\",function($rootScope,$http,$q,Tool){\r\n        //使用promise封装ajax\r\n        this.get = function (obj) {\r\n                if (obj.url) {\r\n                    $rootScope.loading = true;\r\n                    var defered = $q.defer();\r\n                    $http.get(obj.url,{\r\n                        headers:obj.headers,\r\n                    }).success(function (data) {\r\n                        return defered.resolve(data);\r\n                    }).error(function (data) {\r\n                        return defered.reject(data);\r\n                    });\r\n                    return defered.promise;\r\n                }\r\n            };\r\n        this.post = function (obj) {\r\n            if (obj.url) {\r\n                var defered = $q.defer();\r\n                if(obj.headers) {\r\n                    if(!obj.headers[\"Content-type\"]){\r\n                        obj.headers[\"Content-type\"] = 'application/x-www-form-urlencoded;charset=UTF-8';\r\n                    }\r\n                }else{\r\n                    obj.headers = {\r\n                        'Content-type': 'application/x-www-form-urlencoded;charset=UTF-8',\r\n                    };\r\n                }\r\n                $rootScope.loading = true;\r\n                //将参数对象转换成参数字符串\r\n                obj.params = Tool.convertParams(obj.params);\r\n                $http.post(obj.url, obj.params, {\r\n                    headers: obj.headers\r\n                }).success(function (data) {\r\n                    defered.resolve(data);\r\n                }).error(function (data) {\r\n                    defered.reject(data);\r\n                });\r\n                return defered.promise;\r\n            }\r\n        };\r\n    }]);\r\n\r\n    // 工具服务\r\n    app.service(\"Tool\",[\"$rootScope\",\"$location\",function($rootScope,$location){\r\n        \r\n        //变量\r\n        this.host = \"http://192.168.0.104:3000\";\r\n        //this.host = \"https://192.168.0.222:8555/www\"\r\n        this.userInfo = {};\r\n\r\n        /*\r\n        ** 操作localStorage和sessionStorage\r\n        */\r\n        this.getLocal = function(key){\r\n            return JSON.parse(localStorage.getItem(key));\r\n        };\r\n        this.setLocal = function(key,value){\r\n            localStorage.setItem(key,JSON.stringify(value));\r\n        };\r\n        this.removeLocal = function(key){\r\n            localStorage.removeItem(key);\r\n        };\r\n        this.clearLocal = function(){\r\n            localStorage.clear();\r\n        }\r\n        this.getSession = function(key){\r\n            return JSON.parse(sessionStorage.getItem(key));\r\n        }\r\n        this.setSession = function(key,value){\r\n            sessionStorage.setItem(key,JSON.stringify(value));\r\n        }\r\n        this.removeSession = function(key){\r\n            sessionStorage.removeItem(key);\r\n        }\r\n        //跳转到指定url\r\n        this.goUrl = function(url){\r\n            if(url.length>0){\r\n                location.href = url;\r\n            }\r\n        }\r\n\r\n        //改变路由\r\n        this.changeRoute = function(path,search){\r\n            $location.path(path);\r\n            if(search){\r\n                $location.search(search);\r\n            }else{\r\n                $location.search(\"\");\r\n            }\r\n        }\r\n\r\n        //判断是否登录\r\n        this.checkLogin = function(){\r\n            if(this.getLocal(\"user\")){\r\n                return true;\r\n            }else{\r\n                return false;\r\n            }\r\n        }\r\n\r\n        //判断是否完成用户信息\r\n        this.isUserInfoComplete = function(){\r\n            var userInfo = this.getLocal(\"user\");\r\n            if(userInfo.realname==\"\"||userInfo.realname==null||userInfo.sex==\"\"||userInfo.sex==null||userInfo.age==\"\"||userInfo.age==null||userInfo.phone==\"\"||userInfo.phone==null){\r\n                return false;\r\n            }else{\r\n                return true;\r\n            }\r\n        }\r\n        this.select = function(params,obj){\r\n            for(var proto in obj){\r\n                if(proto==params){\r\n                    if(!obj[params].has){\r\n                        obj[params].has = true;\r\n                    }\r\n                }else{\r\n                    if(obj[proto].has){\r\n                        obj[proto].has = false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        //确认按钮的提示框\r\n        this.alert = function(mess,callback){\r\n            $rootScope.message = mess;\r\n            $rootScope.hasCancel = false;\r\n            $rootScope.hasComfirm = true;\r\n            $rootScope.hasTip = true;\r\n            if(callback){\r\n                $rootScope.comfirm = callback;\r\n            }else{\r\n                $rootScope.comfirm = function(){\r\n                    $rootScope.hasTip = false;\r\n                }\r\n            }\r\n        }\r\n\r\n        //确认和取消按钮的提示框\r\n        this.comfirm = function(mess,callback){\r\n            $rootScope.message = mess;\r\n            $rootScope.hasCancel = true;\r\n            $rootScope.hasComfirm = true;\r\n            $rootScope.hasTip = true;\r\n            $rootScope.cancel = function(){\r\n                $rootScope.hasTip = false;\r\n            }\r\n            $rootScope.comfirm = callback;\r\n        }\r\n\r\n        //获取用户信息\r\n        this.loadUserinfo = function(){\r\n            this.userInfo = this.getLocal(\"user\");\r\n        }\r\n\r\n        //将对象转换成查询字符串\r\n        this.convertParams = function(obj){\r\n            var params = \"\";\r\n            for(var property in obj){\r\n                if(obj[property]!=null){\r\n                    params += property+\"=\"+obj[property]+\"&\";\r\n                }\r\n            }\r\n            //截取掉最后一个\"&\"\r\n            params = params.slice(0,params.length-1);\r\n            return params;\r\n        }\r\n\r\n        //不监听window滚动\r\n        this.noWindowListen = function(){\r\n            window.onscroll = null;\r\n        }\r\n    }])\r\n\r\n    // 微信服务\r\n    app.service(\"Weixin\",[\"$rootScope\",\"Ajax\",\"Tool\",function($rootScope,Ajax,Tool){\r\n        //初始化完成后，检查客户端版本 --first--\r\n        this.wxInit = function($scope,callback){\r\n            //wx初始化后检查客户端\r\n            wx.ready(function(){\r\n                wx.checkJsApi({\r\n                    //需要检测的JS接口列表\r\n                    jsApiList: ['getLocation','chooseWXPay','onMenuShareTimeline','onMenuShareAppMessage','onMenuShareQQ','onMenuShareQZone','onMenuShareWeibo'],\r\n                    success: function(result) {\r\n                        //以键值对的形式返回，可用的api值true，不可用为false\r\n                        if(!result.checkResult.getLocation||!result.checkResult.chooseWXPay){\r\n                            Tool.alert(\"客户端版本过低，请微信升级客户端!\");\r\n                        }\r\n                    }\r\n                })\r\n                if(callback){\r\n                    wx.getLocation({\r\n                        type:\"wgs84\",\r\n                        success:function(res){\r\n                            var locationInfo = {\r\n                                latitude:res.latitude, //维度\r\n                                longitude:res.longitude //经度\r\n                            }\r\n                            Tool.setSession(\"locationInfo\",locationInfo);\r\n                            callback(locationInfo.latitude,locationInfo.longitude);\r\n                        },\r\n                        fail:function(){\r\n                            $scope.locationInfo = \"定位失败\";\r\n                        }\r\n                    });\r\n                }\r\n            })\r\n        }\r\n\r\n        //初始化wx对象 --second--\r\n        this.wxConfig = function(scope){\r\n            var params = {\r\n                debug:false,\r\n                appId : \"\",\r\n                timestamp : \"\",\r\n                nonceStr : \"\",\r\n                signature : \"\",\r\n                jsApiList : ['getLocation','chooseWXPay','onMenuShareTimeline','onMenuShareAppMessage','onMenuShareQQ','onMenuShareQZone','onMenuShareWeibo'],\r\n            };\r\n            Ajax.post({\r\n                url:Tool.host+\"/weixin/check/getjsconfig\",\r\n                params: \"url=\"+encodeURIComponent(location.href),\r\n            }).then(function(data){\r\n                params.appId = data.appId;\r\n                params.timestamp = data.timestamp;\r\n                params.nonceStr = data.nonceStr;\r\n                params.signature = data.signature;\r\n                wx.config(params);\r\n            }).catch(function(){\r\n                Tool.alert(\"初始化WX对象失败，请稍后再试！\");\r\n            })\r\n        }\r\n\r\n        //自定义分享内容,可分享至微信好友，微信朋友圈，qq好友，qq空间，腾讯微博\r\n        this.wxShare = function(obj){\r\n            /**\r\n             * title:分享标题, desc:分享描述, link:分享链接, imgUrl:分享图标, type：分享类型，默认为link， dataUrl：分享数据的连接\r\n             */\r\n            wx.onMenuShareTimeline({\r\n                title: obj.title,\r\n                link: obj.link,\r\n                imgUrl: obj.imgUrl,\r\n                success: obj.success,\r\n                cancel: obj.cancel,\r\n            });\r\n            wx.onMenuShareAppMessage({\r\n                title: obj.title,\r\n                desc: obj.desc,\r\n                link: obj.link,\r\n                imgUrl: obj.imgUrl,\r\n                type: obj.type,\r\n                dataUrl: obj.dataUrl,\r\n                success:obj.success,\r\n                cancel: obj.cancel\r\n            });\r\n            wx.onMenuShareQQ({\r\n                title: obj.title,\r\n                desc: obj.desc,\r\n                link: obj.link,\r\n                imgUrl: obj.imgUrl,\r\n                success:obj.success,\r\n                cancel:obj.cancel\r\n            });\r\n            wx.onMenuShareQZone({\r\n                title: obj.title,\r\n                desc: obj.desc,\r\n                link: obj.link,\r\n                imgUrl: obj.imgUrl,\r\n                success: obj.success,\r\n                cancel:obj.cancel,\r\n            });\r\n            wx.onMenuShareWeibo({\r\n                title: obj.title,\r\n                desc: obj.desc,\r\n                link: obj.link,\r\n                imgUrl: obj.imgUrl,\r\n                success: obj.success,\r\n                cancel: obj.cancel,\r\n            });\r\n        }\r\n\r\n        //检查微信支付的参数是否完整\r\n        this.wxCheckPayParams = function(params){\r\n            if(params.timestamp==\"\"||params.timestamp==null||params.nonceStr==\"\"||params.nonceStr==null||params.package==\"\"||params.package==null||params.signType==\"\"||params.signType==null||params.paySign==\"\"||params.paySign==null){\r\n                return false;\r\n            }else{\r\n                return true;\r\n            }\r\n        }\r\n\r\n        //获取支付参数，并发起支付\r\n        this.wxPay = function(orderId,code,scope){\r\n            var params = {\r\n                timestamp: \"\",\r\n                nonceStr: '',\r\n                package: '',\r\n                signType: '',\r\n                paySign: '',\r\n                success:function() {\r\n                    Tool.changeRoute(\"/pay/result\",\"payResult=success\")\r\n                },\r\n                cancel:function(){\r\n                    Tool.changeRoute(\"/pay/result\",\"payResult=fail\");\r\n                },\r\n                fail:function(){\r\n                    Tool.changeRoute(\"/pay/result\",\"payResult=fail\");\r\n                }\r\n            };\r\n            if(orderId!=\"\"&orderId!=null){\r\n                var accessToken = Tool.getLocal(\"accessToken\");\r\n                var url = Tool.host+\"/wx/order/weixin\";\r\n                var params = \"payType=JSAPI&orderId=\"+orderId+\"&code=\"+code;\r\n                Ajax.post({\r\n                    url:url,\r\n                    params:params,\r\n                    headers:{\r\n                        'accessToken':accessToken,\r\n                    }\r\n                }).then(function(data){\r\n                    params.timestamp = data.data.timeStamp;\r\n                    params.nonceStr = data.data.nonceStr;\r\n                    params.package = data.data.package;\r\n                    params.signType = \"MD5\";\r\n                    params.paySign = data.data.sign;\r\n                    if(params.timestamp==\"\"||params.timestamp==null||params.nonceStr==\"\"||params.nonceStr==null||params.package==\"\"||params.package==null||params.signType==\"\"||params.signType==null||params.paySign==\"\"||params.paySign==null){\r\n                        scope.loading = false;\r\n                        Tool.alert(scope,\"请求支付参数失败，请稍后再试!\");\r\n                    }else{\r\n                        scope.loading = false;\r\n                        wx.chooseWXPay(params);\r\n                    }\r\n                }).catch(function(){\r\n                    Tool.alert(\"请求支付参数失败，请稍后再试!\");\r\n                })\r\n            }\r\n        }\r\n    }])\r\n\r\n    // 存储菜单变量\r\n    app.service(\"Params\",[function(){\r\n        this.defaultParams = {\r\n            default:{has:true,id:\"\"}\r\n        }\r\n        this.areaParams = {\r\n            default:{has:true,val:\"\"},\r\n            futian:{has:false,val:\"福田区\"},\r\n            nanshan:{has:false,val:\"南山区\"},\r\n            luohu:{has:false,val:\"罗湖区\"},\r\n            baoan:{has:false,val:\"宝安区\"},\r\n            longhua:{has:false,val:\"龙华新区\"},\r\n            longgang:{has:false,val:\"龙岗区\"},\r\n            yantian:{has:false,val:\"盐田区\"},\r\n        }\r\n        this.yakeParams = {\r\n            all:{has:true,id:\"\"},\r\n            zzy:{has:false,id:19},\r\n            xiya:{has:false,id:20},\r\n            kcy:{has:false,id:82},\r\n            buya:{has:false,id:22},\r\n            baya:{has:false,id:23},\r\n            ycmr:{has:false,id:24},\r\n            jiaozheng:{has:false,id:64},\r\n            yichi:{has:false,id:65},\r\n            yzzl:{has:false,id:63},\r\n            qita:{has:false,id:60},\r\n        };\r\n        this.meirongParams = {\r\n            all:{has:true,id:\"\"},\r\n            yanbu:{has:false,id:7},\r\n            mianbu:{has:false,id:8},\r\n            bibu:{has:false,id:9},\r\n            xiong:{has:false,id:45},\r\n            xizhi:{has:false,id:12},\r\n            simi:{has:false,id:78},\r\n            zhushe:{has:false,id:79},\r\n            jiguang:{has:false,id:80},\r\n            koucun:{has:false,id:81},\r\n            qita:{has:false,id:13},\r\n        };\r\n        this.fckParams = {\r\n            all:{has:true,id:\"\"},\r\n            jiancha:{has:false,id:48},\r\n            fenmian:{has:false,id:49}\r\n        };\r\n        this.zhongyiParams = {\r\n            all:{has:true,id:\"\"},\r\n            toubu:{has:false,id:51},\r\n            jianjing:{has:false,id:52},\r\n            yaobu:{has:false,id:53},\r\n            tuibu:{has:false,id:54},\r\n            quanshen:{has:false,id:55},\r\n            jingluo:{has:false,id:56},\r\n            qita:{has:false,id:57}\r\n        }\r\n        this.tijianParams = {\r\n            default:{has:true,val:\"\"},\r\n            shangye:{has:false,val:75},\r\n            changgui:{has:false,val:67},\r\n            zhongnian:{has:false,val:69},\r\n            laonian:{has:false,val:70},\r\n            ruzhi:{has:false,val:71},\r\n            yunqian:{has:false,val:72},\r\n            qingnian:{has:false,val:68},\r\n            ertong:{has:false,val:74},\r\n            manbing:{has:false,val:73},\r\n        }\r\n        this.professionalParams = {\r\n            default:{has:true,val:this.defaultParams,proId:\"\"},\r\n            yake:{has:false,val:this.yakeParams,proId:\"2\"},\r\n            meirong:{has:false,val:this.meirongParams,proId:\"3\"},\r\n            fck:{has:false,val:this.fckParams,proId:\"4\"},\r\n            zhongyi:{has:false,val:this.zhongyiParams,proId:\"6\"},\r\n            tijian:{has:false,val:this.tijianParams,proId:\"5\"}\r\n        }\r\n    }])\r\n\r\n})"],"sourceRoot":"/source/"}