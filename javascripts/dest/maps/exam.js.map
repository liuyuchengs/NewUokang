{"version":3,"sources":["exam.js"],"names":["define","$scope","$rootScope","$location","Tool","Ajax","params","product","hospital","noProduct","noProductText","products","hospitals","productParams","city","area","professionId","itemId","order","specialty","currentPage","pageRows","hospitalParams","hasBg","hasOrder","hasArea","hasClass","hasSex","menuParams","classes","sex","orderParams","default","has","val","price","priceDesc","scoreDesc","countDesc","areaParams","futian","nanshan","luohu","baoan","longhua","longgang","yantian","classParams","shangye","changgui","zhongnian","laonian","ruzhi","yunqian","qingnian","ertong","manbing","sexParams","men","women","init","getQuery","item","proto","setNext","loadProduct","loadHospital","search","changeRoute","switchMenu","menu","areaSelect","select","orderSelect","classSelect","sexSelect","post","url","host","then","data","length","mergeProdcut","concat","alert","loading","list","forEach","score","items","priceunit","preferPriceType","pricetype","detail","proId","hosId","window","onscroll","body","document","html","documentElement","height","Math","max","scrollHeight","offsetHeight","clientHeight","innerHeight","scrollY","loadNext"],"mappings":"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","file":"exam.js","sourcesContent":["/**\r\n * 体检页面外层控制器\r\n */\r\n\r\ndefine(function(){\r\n\treturn function($scope,$rootScope,$location,Tool,Ajax){\r\n\t\t$scope.params = {\r\n\t\t\tproduct:false,\r\n\t\t\thospital:false\r\n\t\t}\r\n\t\t$scope.noProduct = false;\r\n\t\t$scope.noProductText=\"\";\r\n\t\t$scope.products = [];\r\n\t\t$scope.hospitals = [];\r\n\r\n\t\t$scope.productParams = {\r\n\t\t\tcity:\"深圳\",\r\n\t\t\tarea:\"\",\r\n\t\t\tprofessionId:5,\r\n\t\t\titemId:\"\",\r\n\t\t\torder:\"\",\r\n\t\t\tspecialty:\"\",\r\n\t\t\tcurrentPage:1,\r\n\t\t\tpageRows:10,\r\n\t\t}\r\n\r\n\t\t$scope.hospitalParams = {\r\n\t\t\tcity:\"深圳\",\r\n\t\t\tarea:null,\r\n\t\t\tprofessionId:5,\r\n\t\t\torder:null,\r\n\t\t\tcurrentPage:1,\r\n\t\t\tpageRows:10,\r\n\t\t}\r\n\t\t$scope.hasBg = false;\r\n\t\t//菜单切换变量\r\n\t\t$scope.hasOrder = false;\r\n\t\t$scope.hasArea = false;\r\n\t\t$scope.hasClass = false;\r\n\t\t$scope.hasSex = false;\r\n\t\t//菜单项变量\r\n\t\t$scope.menuParams = {\r\n\t\t\tarea:false,\r\n\t\t\torder:false,\r\n\t\t\tclasses:false,\r\n\t\t\tsex:false,\r\n\t\t}\r\n\r\n\t\t$scope.orderParams = {\r\n\t\t\tdefault:{has:true,val:\"\"},\r\n\t\t\tprice:{has:false,val:\"prefer_price asc\"},\r\n\t\t\tpriceDesc:{has:false,val:\"prefer_price desc\"},\r\n\t\t\tscoreDesc:{has:false,val:\"hospital_score asc\"},\r\n\t\t\tcountDesc:{has:false,val:\"sales desc\"}\r\n\t\t}\r\n\t\t$scope.areaParams = {\r\n\t\t\tdefault:{has:true,val:\"\"},\r\n\t\t\tfutian:{has:false,val:\"福田区\"},\r\n\t\t\tnanshan:{has:false,val:\"南山区\"},\r\n\t\t\tluohu:{has:false,val:\"罗湖区\"},\r\n\t\t\tbaoan:{has:false,val:\"宝安区\"},\r\n\t\t\tlonghua:{has:false,val:\"龙华新区\"},\r\n\t\t\tlonggang:{has:false,val:\"龙岗区\"},\r\n\t\t\tyantian:{has:false,val:\"盐田\"},\r\n\t\t}\r\n\t\t$scope.classParams = {\r\n\t\t\tdefault:{has:true,val:\"\"},\r\n\t\t\tshangye:{has:false,val:75},\r\n\t\t\tchanggui:{has:false,val:67},\r\n\t\t\tzhongnian:{has:false,val:69},\r\n\t\t\tlaonian:{has:false,val:70},\r\n\t\t\truzhi:{has:false,val:71},\r\n\t\t\tyunqian:{has:false,val:72},\r\n\t\t\tqingnian:{has:false,val:68},\r\n\t\t\tertong:{has:false,val:74},\r\n\t\t\tmanbing:{has:false,val:73},\r\n\t\t}\r\n\t\t$scope.sexParams = {\r\n\t\t\tdefault:{has:true,val:\"通用\"},\r\n\t\t\tmen:{has:false,val:\"男\"},\r\n\t\t\twomen:{has:false,val:\"女\"},\r\n\t\t}\r\n\r\n\t\t//初始化页面\r\n\t\t$scope.init = function(){\r\n\t\t\t$scope.getQuery();\r\n\t\t}\r\n\r\n\t\t//切换\r\n\t\t$scope.switch = function(item){\r\n\t\t\tfor(var proto in $scope.params){\r\n\t\t\t\tif(proto===item){\r\n\t\t\t\t\t$scope.params[item] = true;\r\n\t\t\t\t}else{\r\n\t\t\t\t\t$scope.params[proto] = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t$scope.setNext(item);\r\n\t\t\tif(item===\"product\"){\r\n\t\t\t\t$scope.products = [];\r\n\t\t\t\t$scope.productParams.currentPage = 1;\t\r\n\t\t\t\t$scope.loadProduct();\r\n\t\t\t}\r\n\t\t\tif(item===\"hospital\"){\r\n\t\t\t\t$scope.hospitals = [];\r\n\t\t\t\t$scope.hospitalParams.currentPage = 1;\r\n\t\t\t\t$scope.loadHospital();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//获取参数\r\n\t\t$scope.getQuery = function(){\r\n\t\t\tif($location.search().item){\r\n\t\t\t\tvar proto = $location.search().item;\r\n\t\t\t\t$scope.switch(proto);\r\n\t\t\t}else{\r\n\t\t\t\tTool.changeRoute(\"/home\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\t//下拉菜单切换\r\n\t\t$scope.switchMenu =function(menu){\r\n\t\t\tswitch(menu){\r\n\t\t\t\tcase \"area\":\r\n\t\t\t\t\tif($scope.hasOrder){\r\n\t\t\t\t\t\t$scope.hasOrder = false;\r\n\t\t\t\t\t\t$scope.menuParams.order = false;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif($scope.hasClass){\r\n\t\t\t\t\t\t$scope.hasClass = false;\r\n\t\t\t\t\t\t$scope.menuParams.classes = false;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif($scope.hasSex){\r\n\t\t\t\t\t\t$scope.hasSex = false;\r\n\t\t\t\t\t\t$scope.menuParams.sex = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$scope.hasArea = !$scope.hasArea;\r\n\t\t\t\t\tif($scope.hasArea){\r\n\t\t\t\t\t\t$scope.menuParams.area = true;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t$scope.menuParams.area = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"order\":\r\n\t\t\t\t\tif($scope.hasArea){\r\n\t\t\t\t\t\t$scope.hasArea = false;\r\n\t\t\t\t\t\t$scope.menuParams.area = false;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif($scope.hasClass){\r\n\t\t\t\t\t\t$scope.hasClass = false;\r\n\t\t\t\t\t\t$scope.menuParams.classes = false;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif($scope.hasSex){\r\n\t\t\t\t\t\t$scope.hasSex = false;\r\n\t\t\t\t\t\t$scope.menuParams.sex = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$scope.hasOrder = !$scope.hasOrder;\r\n\t\t\t\t\tif($scope.hasOrder){\r\n\t\t\t\t\t\t$scope.menuParams.order = true;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t$scope.menuParams.order = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"class\":\r\n\t\t\t\t\tif($scope.hasOrder){\r\n\t\t\t\t\t\t$scope.hasOrder = false;\r\n\t\t\t\t\t\t$scope.menuParams.order = false;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif($scope.hasArea){\r\n\t\t\t\t\t\t$scope.hasArea = false;\r\n\t\t\t\t\t\t$scope.menuParams.area = false;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif($scope.hasSex){\r\n\t\t\t\t\t\t$scope.hasSex = false;\r\n\t\t\t\t\t\t$scope.menuParams.sex = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$scope.hasClass = !$scope.hasClass;\r\n\t\t\t\t\tif($scope.hasClass){\r\n\t\t\t\t\t\t$scope.menuParams.classes = true;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t$scope.menuParams.classes = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"sex\":\r\n\t\t\t\t\tif($scope.hasOrder){\r\n\t\t\t\t\t\t$scope.hasOrder = false;\r\n\t\t\t\t\t\t$scope.menuParams.order = false;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif($scope.hasArea){\r\n\t\t\t\t\t\t$scope.hasArea = false;\r\n\t\t\t\t\t\t$scope.menuParams.area = false;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif($scope.hasClass){\r\n\t\t\t\t\t\t$scope.hasClass = false;\r\n\t\t\t\t\t\t$scope.menuParams.classes = false;\r\n\t\t\t\t\t};\r\n\t\t\t\t\t$scope.hasSex = !$scope.hasSex;\r\n\t\t\t\t\tif($scope.hasSex){\r\n\t\t\t\t\t\t$scope.menuParams.sex = true;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t$scope.menuParams.sex = false;\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif($scope.hasOrder||$scope.hasArea||$scope.hasClass||$scope.hasSex){\r\n\t\t\t\t$scope.hasBg = true;\r\n\t\t\t}else{\r\n\t\t\t\t$scope.hasBg = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//区域下拉菜单项点击\r\n\t\t$scope.areaSelect =function(params){\r\n\t\t\tTool.select(params,$scope.areaParams);\r\n\t\t\t$scope.productParams.area = $scope.areaParams[params].val;\r\n\t\t\t$scope.productParams.currentPage = 0;\r\n\t\t\t$scope.products = [];\r\n\t\t\t$scope.noProduct = false;\r\n\t\t\t$scope.loadProduct();\r\n\t\t\t$scope.switchMenu(\"area\");\r\n\t\t}\r\n\r\n\t\t//排序下拉菜单项点击\r\n\t\t$scope.orderSelect = function(params){\r\n\t\t\tTool.select(params,$scope.orderParams);\r\n\t\t\t$scope.productParams.order = $scope.orderParams[params].val;\r\n\t\t\t$scope.productParams.currentPage = 0;\r\n\t\t\t$scope.products = [];\r\n\t\t\t$scope.noProduct = false;\r\n\t\t\t$scope.loadProduct();\r\n\t\t\t$scope.switchMenu(\"order\");\r\n\t\t}\r\n\r\n\t\t//类别下拉菜单项点击\r\n\t\t$scope.classSelect = function(params){\r\n\t\t\tTool.select(params,$scope.classParams);\r\n\t\t\t$scope.productParams.itemId = $scope.classParams[params].val;\r\n\t\t\t$scope.productParams.currentPage = 0;\r\n\t\t\t$scope.products = [];\r\n\t\t\t$scope.noProduct = false;\r\n\t\t\t$scope.loadProduct();\r\n\t\t\t$scope.switchMenu(\"class\");\r\n\t\t}\r\n\r\n\t\t//性别下拉菜单项点击\r\n\t\t$scope.sexSelect = function(params){\r\n\t\t\tTool.select(params,$scope.sexParams);\r\n\t\t\t$scope.productParams.specialty = $scope.sexParams[params].val;\r\n\t\t\t$scope.productParams.currentPage = 0;\r\n\t\t\t$scope.products = [];\r\n\t\t\t$scope.noProduct = false;\r\n\t\t\t$scope.loadProduct();\r\n\t\t\t$scope.switchMenu(\"sex\");\r\n\t\t}\r\n\r\n\t\t//加载体检项目\r\n\t\t$scope.loadProduct = function(){\r\n\t\t\tAjax.post({\r\n\t\t\t\turl:Tool.host+\"/wx/product/querylist\",\r\n\t\t\t\tparams:$scope.productParams,\r\n\t\t\t}).then(function(data){\r\n\t\t\t\tif(data.length<1){\r\n\t\t\t\t\tif($scope.products.length<1){\r\n\t\t\t\t\t\t$scope.noProductText = \"没有项目信息,请选择其他区域或者时间!\";\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t$scope.noProductText = \"已经没有项目了!\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$scope.noProduct = true;\r\n\t\t\t\t}else{\r\n\t\t\t\t\t$scope.mergeProdcut(data);\r\n\t\t\t\t\t$scope.products = $scope.products.concat(data);\r\n\t\t\t\t}\r\n\t\t\t}).catch(function(){\r\n\t\t\t\t$scope.noProduct = true;\r\n\t\t\t\tTool.alert(\"查询数据失败，请稍后再试！\");\r\n\t\t\t}).finally(function(){\r\n\t\t\t\t$rootScope.loading = false;\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\t//加载医院信息\r\n\t\t$scope.loadHospital = function(){\r\n\t\t\tAjax.post({\r\n\t\t\t\turl:Tool.host+\"/wx/hospital/querylist\",\r\n\t\t\t\tparams:$scope.hospitalParams,\r\n\t\t\t}).then(function(data){\r\n\t\t\t\tif(data.list.length>0){\r\n\t\t\t\t\tdata.list.forEach(function(item){\r\n\t\t\t\t\t\tif(item.score==\"\"||item.score==null){\r\n\t\t\t\t\t\t\titem.score = \"暂无评分\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t$scope.hospitals = $scope.hospitals.concat(data.list);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tif($scope.hospitals.length<1){\r\n\t\t\t\t\t\t$scope.noProductText = \"没有项目信息,请选择其他区域或者时间!\";\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t$scope.noProductText = \"已经没有项目了!\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$scope.noProduct = true;\r\n\t\t\t\t}\r\n\t\t\t}).catch(function(){\r\n\t\t\t\tTool.alert(\"加载数据失败，请稍后再试!\");\r\n\t\t\t}).finally(function(){\r\n\t\t\t\t$rootScope.loading = false;\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\t//合并价格单位,如：元/次\r\n\t\t$scope.mergeProdcut = function(items){\r\n\t\t\titems.forEach(function(item){\r\n\t\t\t\tif(item.priceunit!=null&&item.priceunit!=\"\"){\r\n\t\t\t\t\titem.preferPriceType = item.pricetype+\"/\"+item.priceunit;\r\n\t\t\t\t}else{\r\n\t\t\t\t\titem.preferPriceType = item.pricetype;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\t//跳转到套餐详细页面\r\n\t\t$scope.detail = function(proId,hosId){\r\n\t\t\tTool.changeRoute(\"/exam/detail\",\"productId=\"+proId+\"&hospitalId=\"+hosId);\r\n\t\t}\r\n\r\n\t\t//滚动监听\r\n\t\twindow.onscroll = function(){\r\n\t\t\tif($rootScope.loading||$scope.noProduct){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar body = document.body;\r\n\t\t\tvar html = document.documentElement;\r\n\t\t\tvar height = Math.max( body.scrollHeight, body.offsetHeight,html.clientHeight, html.scrollHeight, html.offsetHeight );\r\n\t\t\tif(height>window.innerHeight){\r\n\t\t\t\tif (height - window.scrollY - window.innerHeight < 100) {\r\n\t\t\t\t\t$scope.loadNext();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//设置滚动加载\r\n\t\t$scope.setNext = function(item){\r\n\t\t\tif(item===\"product\"){\r\n\t\t\t\t$scope.loadNext = function(){\r\n\t\t\t\t\t$scope.productParams.currentPage++;\r\n\t\t\t\t\t$scope.loadProduct();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(item===\"hospital\"){\r\n\t\t\t\t$scope.loadNext = function(){\r\n\t\t\t\t\t$scope.hospitalParams.currentPage++;\r\n\t\t\t\t\t$scope.loadHospital();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n})\r\n"],"sourceRoot":"/source/"}